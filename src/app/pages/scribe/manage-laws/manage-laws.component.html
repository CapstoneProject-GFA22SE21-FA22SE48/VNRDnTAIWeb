<!--Screen 1: Not select statue yet -->
<div
  [ngClass]="{
    'h-full flex p-0': selectedStatue === undefined,
    hidden: selectedStatue
  }"
>
  <!-- Left -->
  <div class="h-full w-8">
    <div style="height: 7%" class="p-2 pb-3 flex">
      <div class="w-6">
        <fa-icon class="fa-lg mr-2" [icon]="['fas', 'scale-balanced']"></fa-icon>
        <span class="text-xl">Quản lý luật</span>
      </div>
      
      <div class="w-6 flex justify-content-end">
        <button
          pButton
          pRipple
          type="button"
          icon="pi pi-refresh"
          class="p-button-rounded p-button-text"
          [style]="{ height: '25px', width: '25px' }"
          (click)="ngOnInit()"
        ></button>
      </div>
    </div>

    <div style="height: 8%" class="p-2">
      <div class="flex mb-3">
        <div class="w-6 flex justify-content-start">
          <div>
            <p-dropdown
              [(ngModel)]="selectedStatue"
              [options]="tmpStatues"
              placeholder="Điều..."
              optionLabel="name"
              [showClear]="true"
              scrollHeight="10rem"
              [filter]="true"
              filterBy="name"
              [style]="{ height: '35px' }"
              (onChange)="selectStatue()"
            ></p-dropdown>
          </div>
        </div>
        <div class="w-6 flex justify-content-end">
          <button
            pButton
            type="button"
            label="Tạo mới"
            class="p-button-raised p-button-success"
            [style]="{ height: '40px' }"
            (click)="
              displayAddNewLawDialog = true;
              isShowingStatueDialog = true;
              selectedChangingDecree = undefined
            "
          ></button>
        </div>
      </div>
    </div>

    <div style="height: 10%" class="p-2">
      <div class="flex align-items-center">
        <div class="flex justify-content-start" style="width: 35%">
          <div class="w-full">
            <span class="p-input-icon-right mr-3 w-full">
              <i class="pi pi-search"></i>
              <input
                type="text"
                pInputText
                placeholder="Tìm kiếm điều..."
                id="input-search"
                [(ngModel)]="searchStatueStr"
                [style]="{ height: '35px', width: '100%' }"
                (keyup)="filterStatueData()"
              />
            </span>
          </div>
        </div>
      </div>
    </div>

    <div style="height: 75%" class="p-1 overflow-auto">
      <p-table
        [value]="statues"
        [paginator]="statues?.length > 8 ? true : false"
        [rows]="8"
        [showCurrentPageReport]="statues?.length > 8 ? true : false"
        responsiveLayout="scroll"
        currentPageReportTemplate="{first} đến {last} trong tổng số {totalRecords} mục"
        styleClass="p-datatable-gridlines p-datatable-sm"
      >
        <ng-template pTemplate="header">
          <tr>
            <th [ngStyle]="{ width: '5%', 'text-align': 'center' }">#</th>
            <th [ngStyle]="{ width: '15%', 'text-align': 'center' }">Điều</th>
            <th [ngStyle]="{ width: '70%', 'text-align': 'center' }">
              Nội dung
            </th>
            <th [ngStyle]="{ width: '10%', 'text-align': 'center' }"></th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-statue let-i="rowIndex">
          <tr>
            <td class="text-center">
              {{ i + 1 }}
            </td>
            <td class="text-center">
              <div
                class="w-7rem overflow-hidden white-space-nowrap text-overflow-ellipsis text-center"
              >
                <span>{{ statue.name }}</span>
              </div>
            </td>
            <td class="text-center">
              <div
                class="overflow-hidden white-space-nowrap text-overflow-ellipsis text-center"
                style="width: 35rem"
              >
                {{ statue.description }}
              </div>
            </td>
            <td class="text-center">
              <button
                pButton
                type="button"
                icon="pi pi-info"
                class="p-button-rounded p-button-outlined btn-info"
                style="width: 25px !important; height: 25px !important"
                (click)="viewStatueInfo(statue)"
              ></button>
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="4">
              <span class="font-bold">Không tìm thấy kết quả</span>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>

  <!-- Right default -->
  <div
    [ngClass]="{
      'h-full w-4 border-left-3 border-300 p-2': chosenStatue === undefined,
      hidden: chosenStatue
    }"
  >
    <div class="flex align-items-center mb-3">
      <i class="pi pi-info-circle text-xl"></i>
      <span class="text-xl ml-2">Thông tin</span>
    </div>

    <div id="right-default-content" class="text-lg">
      <div class="mb-3">
        <span>Bạn đang quản lý các Điều trong: </span>
      </div>

      <div class="flex">
        <div class="w-4 mb-3">
          <span>Nghị định: </span>
        </div>
        <div class="w-8 mb-3">
          <span> {{ decree?.name }}</span>
        </div>
      </div>

      <div class="flex mb-1">
        <div class="w-4">
          <span>Mục: </span>
        </div>
        <div class="w-8">
          <span class="font-bold text-blue-500"> {{ column?.name }}</span>
        </div>
      </div>

      <div class="flex align-items-center justify-content-center">
        <div class="surface-200 w-12 border-left-2 border-400 p-2">
          {{ column?.description }}
        </div>
      </div>
    </div>
  </div>

  <!-- Right with chosen statue -->
  <div
    [ngClass]="{
      'h-full w-4 border-left-3 border-300':
        chosenStatue && !isUpdatingChosenStatue,
      hidden: chosenStatue === undefined || isUpdatingChosenStatue
    }"
  >
    <div class="border-bottom-3 border-300 p-2" style="height: 20%">
      <div class="flex align-items-center text-xl mb-2">
        <i class="pi pi-info-circle text-xl"></i>
        <span class="ml-2">Thông tin chung</span>
      </div>
      <div class="flex text-lg mb-3">
        <div class="w-4">
          <span>Nghị định: </span>
        </div>
        <div class="w-8">
          <span> {{ decree?.name }}</span>
        </div>
      </div>

      <div class="flex text-lg mb-3">
        <div class="w-4">
          <span>Mục: </span>
        </div>
        <div class="w-8">
          <span> {{ column?.name }}</span>
        </div>
      </div>
    </div>

    <div style="height: 80%" class="p-2">
      <div style="height: 80%">
        <div class="text-xl mb-3">
          <i class="pi pi-info-circle text-xl"></i>
          <span class="ml-2">Chi tiết</span>
        </div>

        <div class="text-lg mb-2">
          <div class="flex">
            <div class="w-4">
              <span>Điều: </span>
            </div>
            <div class="w-8">
              <span class="font-bold text-blue-500">
                {{ chosenStatue?.name }}</span
              >
            </div>
          </div>
        </div>

        <div class="text-lg">Nội dung:</div>

        <div
          class="flex justify-content-center text-lg mb-2 overflow-x-hidden overflow-y-auto surface-200 w-12 border-left-2 border-400"
          style="max-height: 30%"
        >
          <div class="p-2 h-full">
            {{ chosenStatue?.description }}
          </div>
        </div>
      </div>
      <div style="height: 20%">
        <div class="mb-2">
          <button
            pButton
            pRipple
            type="button"
            label="Quản lý các Khoản"
            class="p-button-outlined"
            [style]="{ border: '3px solid #3B82F6', height: '40px' }"
            (click)="goToManageSectionsOfChosenStatue()"
          ></button>
        </div>
        <div class="flex">
          <div class="w-6">
            <button
              pButton
              pRipple
              type="button"
              label="Chỉnh sửa"
              class="p-button-raised p-button-warning"
              [style]="{ height: '40px' }"
              (click)="openUpdateChosenStatue()"
            ></button>
          </div>
          <div class="w-6 text-right">
            <button
              pButton
              pRipple
              type="button"
              label="Bãi bỏ"
              class="p-button-raised p-button-danger"
              [style]="{ height: '40px' }"
              (click)="
                displayConfirmDeleteStatueDialog = true; getApprovalRate()
              "
            ></button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Right for updating chosenStatue -->
  <div
    [ngClass]="{
      'h-full w-4 border-left-3 border-300': isUpdatingChosenStatue,
      hidden: !isUpdatingChosenStatue
    }"
  >
    <div class="p-2" style="height: 90%">
      <div class="flex align-items-center text-xl mb-2">
        <i class="pi pi-file-edit text-xl"></i>
        <span class="ml-2">Chỉnh sửa</span>
      </div>

      <div class="text-lg mb-2">
        <div class="flex">
          <div class="w-4">
            <span>Điều: </span>
          </div>
          <div class="w-8">
            <span class="font-bold text-blue-500">
              {{ chosenStatue?.name }}</span
            >
          </div>
        </div>
      </div>

      <div class="text-lg">Nội dung:</div>
      <div class="text-lg">
        <textarea
          class="w-full h-7rem overflow-y-auto"
          [rows]="10"
          pInputTextarea
          [autoResize]="true"
          value="{{ newChosenStatueDesc }}"
          [(ngModel)]="newChosenStatueDesc"
          (keyup)="getUpdatedStatueDescription($event)"
        ></textarea>
      </div>
      <span
        class="p-error block"
        *ngIf="invalidChosenStatueNewDesc || !tmpChosenStatue?.description"
        >Vui lòng nhập nội dung của điều (tối đa 2000 ký tự)</span
      >

      <div class="text-lg flex align-items-center">
        <div class="w-4">Gửi yêu cầu tới</div>
        <div class="w-8 flex flex-row-reverse">
          <p-dropdown
            [options]="admins"
            optionLabel="username"
            [(ngModel)]="selectedAdmin"
            scrollHeight="6rem"
            [filter]="true"
            filterBy="username"
            [style]="{ width: '10rem', height: '35px' }"
            class="dropdown-admins"
          >
            <ng-template
              let-admin
              pTemplate="item"
              class="dropdown-admins-tooltip"
            >
              <div
                [pTooltip]="admin.pendingRequests"
                tooltipPosition="left"
                class="w-full h-3rem flex justify-content-center align-items-center whitespace-no-wrap text-overflow-ellipsis"
              >
                <span>{{ admin.username }}</span>
              </div>
            </ng-template>
          </p-dropdown>
        </div>
      </div>
    </div>

    <div class="p-2" style="height: 10%">
      <div class="flex align-items-center">
        <div class="w-6">
          <button
            pButton
            pRipple
            type="button"
            label="Cập nhật"
            class="p-button-raised p-button-success"
            [style]="{ height: '40px' }"
            [disabled]="!isValidUpdatingStatue"
            (click)="displayConfirmUpdateStatueDialog = true; getApprovalRate()"
          ></button>
        </div>
        <div class="w-6 flex flex-row-reverse">
          <button
            pButton
            pRipple
            type="button"
            label="Hủy bỏ"
            class="p-button-outlined p-button-danger"
            [style]="{ border: '3px solid #EF4450', height: '40px' }"
            (click)="cancelUpdateChosenStatue()"
          ></button>
        </div>
      </div>
    </div>
  </div>
</div>

<!--Screen 2:  Statue selected -> manage sections -->
<div
  [ngClass]="{
    'h-full flex p-0': selectedStatue && selectedSection === undefined,
    hidden: selectedStatue === undefined || selectedSection
  }"
>
  <!-- Left -->
  <div class="h-full w-8">
    <div style="height: 7%" class="p-2 pb-3 flex">
      <div class="w-6">
        <fa-icon class="fa-lg mr-2" [icon]="['fas', 'scale-balanced']"></fa-icon>
        <span class="text-xl">Quản lý luật</span>
      </div>
      
      <div class="w-6 flex justify-content-end">
        <button
          pButton
          pRipple
          type="button"
          icon="pi pi-refresh"
          class="p-button-rounded p-button-text"
          [style]="{ height: '25px', width: '25px' }"
          (click)="ngOnInit()"
        ></button>
      </div>
    </div>

    <div style="height: 8%" class="p-2">
      <div class="flex mb-3">
        <div class="flex justify-content-between" style="width: 37%">
          <p-dropdown
            [(ngModel)]="selectedStatue"
            [options]="tmpStatues"
            placeholder="Điều..."
            optionLabel="name"
            [showClear]="true"
            [style]="{ height: '35px' }"
            scrollHeight="10rem"
            [filter]="true"
            filterBy="name"
            (onChange)="selectStatue()"
            (onClear)="clearStatue()"
          ></p-dropdown>

          <p-dropdown
            [(ngModel)]="selectedSection"
            [options]="tmpSections"
            placeholder="Khoản..."
            optionLabel="name"
            [showClear]="true"
            [style]="{ height: '35px' }"
            scrollHeight="10rem"
            [filter]="true"
            filterBy="name"
            (onChange)="selectSection()"
            (onClear)="clearSection()"
          ></p-dropdown>
        </div>
        <div class="flex justify-content-end" style="width: 63%">
          <button
            pButton
            type="button"
            label="Tạo mới"
            class="p-button-raised p-button-success"
            [style]="{ height: '40px' }"
            (click)="displayAddNewSection()"
          ></button>
        </div>
      </div>
    </div>

    <div style="height: 10%" class="p-2">
      <div class="flex align-items-center">
        <div class="flex justify-content-start" style="width: 37%">
          <div class="w-full">
            <span class="p-input-icon-right mr-3 w-full">
              <i class="pi pi-search"></i>
              <input
                type="text"
                pInputText
                placeholder="Tìm kiếm khoản..."
                [(ngModel)]="searchSectionStr"
                [style]="{ height: '35px', width: '100%' }"
                (keyup)="filterSectionData()"
              />
            </span>
          </div>
        </div>

        <div
          class="flex justify-content-end align-items-center"
          style="width: 63%"
        >
          <span class="text-lg mr-2">Mức phạt: </span>
          <p-inputNumber
            [(ngModel)]="filterSectionMinPenalty"
            class="mr-2"
            [ngClass]="{
              'ng-invalid ng-dirty': invalidFilterSectionMinPenalty
            }"
            inputId="integeronly"
            inputId="minmax"
            [min]="10000"
            [inputStyle]="{ width: '7rem', height: '35px' }"
            placeholder="Tối thiểu..."
            (onInput)="checkFilterSectionMinPenalty($event)"
          >
          </p-inputNumber>

          <p-inputNumber
            [(ngModel)]="filterSectionMaxPenalty"
            class="mr-2"
            [ngClass]="{
              'ng-invalid ng-dirty': invalidFilterSectionMaxPenalty
            }"
            inputId="integeronly"
            inputId="mixmax"
            [min]="10000"
            [inputStyle]="{ width: '7rem', height: '35px' }"
            placeholder="Tối đa..."
            (onInput)="checkFilterSectionMaxPenalty($event)"
          ></p-inputNumber>

          <p-dropdown
            [(ngModel)]="filterSectionVehicleCategory"
            id="section-dropdown-vehicleCat"
            [options]="vehicleCats"
            optionLabel="name"
            placeholder="Phương tiện..."
            [style]="{ height: '35px', width: '10rem' }"
            scrollHeight="6rem"
            [filter]="true"
            filterBy="name"
            [showClear]="true"
            (onChange)="filterSectionData()"
          ></p-dropdown>
        </div>
      </div>
      <div class="flex">
        <div style="margin-left: 50%">
          <small class="p-error block">
            {{
              invalidFilterSectionMinPenaltyMsg ||
                invalidFilterSectionMaxPenaltyMsg
            }}
          </small>
        </div>
      </div>
    </div>

    <div style="height: 75%" class="p-2 overflow-auto">
      <p-table
        [value]="sections"
        [paginator]="sections?.length > 8 ? true : false"
        [rows]="8"
        [showCurrentPageReport]="sections?.length > 8 ? true : false"
        responsiveLayout="scroll"
        currentPageReportTemplate="{first} đến {last} trong tổng số {totalRecords} mục"
        styleClass="p-datatable-gridlines p-datatable-sm"
      >
        <ng-template pTemplate="header">
          <tr>
            <th [ngStyle]="{ width: '5%', 'text-align': 'center' }">#</th>
            <th [ngStyle]="{ width: '10%', 'text-align': 'center' }">Khoản</th>
            <th [ngStyle]="{ width: '40%', 'text-align': 'center' }">
              Nội dung
            </th>
            <th [ngStyle]="{ width: '15%', 'text-align': 'center' }">
              Phương tiện
            </th>
            <th [ngStyle]="{ width: '25%', 'text-align': 'center' }">
              Mức phạt
            </th>
            <th [ngStyle]="{ width: '5%', 'text-align': 'center' }"></th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-section let-i="rowIndex">
          <tr>
            <td class="text-center">
              {{ i + 1 }}
            </td>
            <td class="text-center">
              <div
                class="w-5rem overflow-hidden white-space-nowrap text-overflow-ellipsis text-center"
              >
                <span>{{ section.name }}</span>
              </div>
            </td>
            <td class="text-center">
              <div
                class="w-20rem overflow-hidden white-space-nowrap text-overflow-ellipsis text-center"
              >
                <span>{{ section.description }}</span>
              </div>
            </td>
            <td class="text-center">
              {{ section.vehicleCategory?.name }}
            </td>
            <td class="text-center">
              {{ section.minPenalty | currency: "VND" }} -
              {{ section.maxPenalty | currency: "VND" }}
            </td>
            <td class="text-center">
              <button
                pButton
                type="button"
                icon="pi pi-info"
                class="p-button-rounded p-button-outlined btn-info"
                style="width: 25px !important; height: 25px !important"
                (click)="viewSectionInfo(section)"
              ></button>
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="6">
              <span class="font-bold">Không tìm thấy kết quả</span>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>

  <!-- Right default -->
  <div
    [ngClass]="{
      'h-full w-4 border-left-3 border-300 p-2': chosenSection === undefined,
      hidden: chosenSection
    }"
  >
    <div class="flex align-items-center mb-3">
      <i class="pi pi-info-circle text-xl"></i>
      <span class="text-xl ml-2">Thông tin</span>
    </div>

    <div id="right-default-content" class="text-lg">
      <div class="mb-3">
        <span>Bạn đang quản lý các Khoản trong: </span>
      </div>

      <div class="flex mb-3">
        <div class="w-4">
          <span>Nghị định: </span>
        </div>
        <div class="w-8">
          <span> {{ decree?.name }}</span>
        </div>
      </div>

      <div class="flex mb-3">
        <div class="w-4">
          <span>Mục: </span>
        </div>
        <div class="w-8">
          <span> {{ column?.name }}</span>
        </div>
      </div>

      <div class="flex mb-1">
        <div class="w-4">
          <span>Điều: </span>
        </div>
        <div class="w-8">
          <span> {{ selectedStatue?.name }}</span>
        </div>
      </div>

      <div class="flex align-items-center justify-content-center mb-2">
        <div class="surface-200 w-12 border-left-2 border-400 p-2">
          {{ selectedStatue?.description }}
        </div>
      </div>

      <div>
        <button
          pButton
          pRipple
          type="button"
          label="Quay lại quản lý các Điều"
          class="p-button-outlined"
          [style]="{ border: '3px solid #3B82F6', height: '40px' }"
          (click)="returnToManegeStatues()"
        ></button>
      </div>
    </div>
  </div>

  <!-- Right with chosen section -->
  <div
    [ngClass]="{
      'h-full w-4 border-left-3 border-300':
        chosenSection && !isUpdatingChosenSection,
      hidden: chosenSection === undefined || isUpdatingChosenSection
    }"
  >
    <div class="border-bottom-3 border-300 p-2" style="height: 25%">
      <div class="flex align-items-center text-xl mb-2">
        <i class="pi pi-info-circle text-xl"></i>
        <span class="ml-2">Thông tin chung</span>
      </div>
      <div class="flex text-lg mb-3">
        <div class="w-4">
          <span>Nghị định: </span>
        </div>
        <div class="w-8">
          <span> {{ decree?.name }}</span>
        </div>
      </div>

      <div class="flex text-lg mb-3">
        <div class="w-4">
          <span>Mục: </span>
        </div>
        <div class="w-8">
          <span> {{ column?.name }}</span>
        </div>
      </div>

      <div class="flex text-lg">
        <div class="w-4">
          <span>Điều: </span>
        </div>
        <div class="w-8">
          <span> {{ selectedStatue?.name }}</span>
        </div>
      </div>
    </div>

    <div style="height: 75%" class="p-2">
      <div style="height: 80%">
        <div class="text-xl mb-3">
          <i class="pi pi-info-circle text-xl"></i>
          <span class="ml-2">Chi tiết</span>
        </div>

        <div class="text-lg mb-2">
          <div class="flex">
            <div class="w-4">
              <span>Khoản: </span>
            </div>
            <div class="w-8">
              <span class="font-bold text-blue-500">
                {{ chosenSection?.name }}</span
              >
            </div>
          </div>
        </div>

        <div class="text-lg">Nội dung:</div>

        <div
          class="flex justify-content-center text-lg mb-2 overflow-x-hidden overflow-y-auto surface-200 w-12 border-left-2 border-400"
          style="max-height: 30%"
        >
          <div class="p-2 h-full">
            {{ chosenSection?.description }}
          </div>
        </div>

        <div class="text-lg mb-2">
          <div class="flex">
            <div class="w-4">
              <span>Phương tiện: </span>
            </div>
            <div class="w-8">
              <span> {{ chosenSection?.vehicleCategory?.name }}</span>
            </div>
          </div>
        </div>

        <div class="text-lg mb-2">
          <span>Mức phạt: </span>
        </div>

        <!-- If have min and max penalty -->
        <div class="text-lg mb-2 ml-4">
          <div class="flex" *ngIf="chosenSection?.minPenalty !== 0">
            <div class="w-4">
              <span>Tối thiểu: </span>
            </div>
            <div class="w-8">
              <span class="text-blue-500">
                {{ chosenSection?.minPenalty | currency: "VND" }}</span
              >
            </div>
          </div>

          <div class="flex" *ngIf="chosenSection?.maxPenalty !== 0">
            <div class="w-4">
              <span>Tối đa: </span>
            </div>
            <div class="w-8">
              <span class="text-red-500">
                {{ chosenSection?.maxPenalty | currency: "VND" }}</span
              >
            </div>
          </div>
        </div>

        <!-- If do not have min and max penalty -->
        <div
          class="text-lg mb-2"
          *ngIf="
            chosenSection?.minPenalty === 0 && chosenSection?.maxPenalty === 0
          "
        >
          <span class="font-bold text-red-500">Phạt cảnh cáo</span>
        </div>
      </div>
      <div style="height: 20%">
        <div class="mb-2">
          <button
            pButton
            pRipple
            type="button"
            label="Quản lý các Điểm"
            class="p-button-outlined"
            [style]="{ border: '3px solid #3B82F6', height: '40px' }"
            (click)="goToManageParagraphsOfChosenSection()"
          ></button>
        </div>
        <div class="flex">
          <div class="w-6">
            <button
              pButton
              pRipple
              type="button"
              label="Chỉnh sửa"
              class="p-button-raised p-button-warning"
              [style]="{ height: '40px' }"
              (click)="openUpdateChosenSection()"
            ></button>
          </div>
          <div class="w-6 text-right">
            <button
              pButton
              pRipple
              type="button"
              label="Bãi bỏ"
              class="p-button-raised p-button-danger"
              [style]="{ height: '40px' }"
              (click)="
                displayConfirmDeleteSectionDialog = true; getApprovalRate()
              "
            ></button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Right for updating chosenSection -->
  <div
    [ngClass]="{
      'h-full w-4 border-left-3 border-300': isUpdatingChosenSection,
      hidden: !isUpdatingChosenSection
    }"
  >
    <div class="p-2" style="height: 90%">
      <div class="flex align-items-center text-xl mb-2">
        <i class="pi pi-file-edit text-xl"></i>
        <span class="ml-2">Chỉnh sửa</span>
      </div>

      <div class="text-lg mb-2">
        <div class="flex">
          <div class="w-4">
            <span>Khoản: </span>
          </div>
          <div class="w-8">
            <span class="font-bold text-blue-500">
              {{ chosenSection?.name }}</span
            >
          </div>
        </div>
      </div>

      <div class="text-lg">Nội dung:</div>
      <div class="text-lg">
        <textarea
          class="w-full h-7rem overflow-y-auto"
          [rows]="10"
          pInputTextarea
          [autoResize]="true"
          value="{{ newChosenSectionDesc }}"
          [(ngModel)]="newChosenSectionDesc"
          (keyup)="getUpdatedSectionDescription($event)"
        ></textarea>
      </div>
      <span
        class="p-error block"
        *ngIf="invalidChosenSectionNewDesc || !tmpChosenSection?.description"
        >Vui lòng nhập nội dung của khoản (tối đa 2000 ký tự)</span
      >

      <div class="text-lg mb-2">
        <div class="flex">
          <div class="w-4">
            <span>Phương tiện: </span>
          </div>
          <div class="w-8 flex flex-row-reverse">
            <p-dropdown
              [options]="vehicleCats"
              optionLabel="name"
              optionValue="id"
              scrollHeight="6rem"
              [filter]="true"
              filterBy="name"
              [style]="{ width: '8rem', height: '35px' }"
              [(ngModel)]="selectedChosenSectionVehicleCatId"
              (onChange)="changeChosenSectionVehicleCat()"
            ></p-dropdown>
          </div>
        </div>
      </div>

      <div class="text-lg mb-2">
        <span>Mức phạt: </span>
      </div>

      <div class="text-lg mb-2 ml-4">
        <div
          class="flex align-items-center mb-2"
          *ngIf="tmpChosenSection?.minPenalty !== 0"
        >
          <div class="w-4">
            <span>Tối thiểu: </span>
          </div>
          <div class="w-8 flex flex-row-reverse">
            <p-inputNumber
              inputId="integeronly"
              inputId="minmax"
              [min]="50000"
              [max]="75000000"
              [(ngModel)]="newChosenSectionMinPenalty"
              [inputStyle]="{ width: '10rem', height: '35px' }"
              (onInput)="checkChosenSectionNewMinPenalty($event)"
            >
            </p-inputNumber>
          </div>
        </div>

        <div
          class="flex align-items-center"
          *ngIf="tmpChosenSection?.maxPenalty !== 0"
        >
          <div class="w-4">
            <span>Tối đa: </span>
          </div>
          <div class="w-8 flex flex-row-reverse">
            <p-inputNumber
              inputId="integeronly"
              inputId="minmax"
              [min]="50000"
              [max]="75000000"
              [(ngModel)]="newChosenSectionMaxPenalty"
              [inputStyle]="{ width: '10rem', height: '35px' }"
              (onInput)="checkChosenSectionNewMaxPenalty($event)"
            >
            </p-inputNumber>
          </div>
        </div>
      </div>
      <small class="p-error block" *ngIf="invalidChosenSectionNewPenaltyMsg">{{
        invalidChosenSectionNewPenaltyMsg
      }}</small>

      <div class="text-lg flex align-items-center">
        <div class="w-4">Gửi yêu cầu tới</div>
        <div class="w-8 flex flex-row-reverse">
          <p-dropdown
            [options]="admins"
            optionLabel="username"
            [(ngModel)]="selectedAdmin"
            scrollHeight="6rem"
            [filter]="true"
            filterBy="username"
            [style]="{ width: '10rem', height: '35px' }"
            class="dropdown-admins"
          >
            <ng-template
              let-admin
              pTemplate="item"
              class="dropdown-admins-tooltip"
            >
              <div
                [pTooltip]="admin.pendingRequests"
                tooltipPosition="left"
                class="w-full h-3rem flex justify-content-center align-items-center whitespace-no-wrap text-overflow-ellipsis"
              >
                <span>{{ admin.username }}</span>
              </div>
            </ng-template>
          </p-dropdown>
        </div>
      </div>
    </div>

    <div class="p-2" style="height: 10%">
      <div class="flex align-items-center">
        <div class="w-6">
          <button
            pButton
            pRipple
            type="button"
            label="Cập nhật"
            class="p-button-raised p-button-success"
            [style]="{ height: '40px' }"
            [disabled]="!isValidUpdatingSection"
            (click)="
              displayConfirmUpdateSectionDialog = true; getApprovalRate()
            "
          ></button>
        </div>
        <div class="w-6 flex flex-row-reverse">
          <button
            pButton
            pRipple
            type="button"
            label="Hủy bỏ"
            class="p-button-outlined p-button-danger"
            [style]="{ border: '3px solid #EF4450', height: '40px' }"
            (click)="cancelUpdateChosenSection()"
          ></button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Screen 3: Section selected -> manage paragraphs -->
<div
  [ngClass]="{
    'h-full flex p-0': selectedStatue && selectedSection,
    hidden: selectedStatue === undefined || selectedSection === undefined
  }"
>
  <!-- Left -->
  <div class="h-full w-8">
    <div style="height: 7%" class="p-2 pb-3 flex">
      <div class="w-6">
        <fa-icon class="fa-lg mr-2" [icon]="['fas', 'scale-balanced']"></fa-icon>
        <span class="text-xl">Quản lý luật</span>
      </div>
      
      <div class="w-6 flex justify-content-end">
        <button
          pButton
          pRipple
          type="button"
          icon="pi pi-refresh"
          class="p-button-rounded p-button-text"
          [style]="{ height: '25px', width: '25px' }"
          (click)="ngOnInit()"
        ></button>
      </div>
    </div>

    <div style="height: 8%" class="p-2">
      <div class="flex mb-3">
        <div class="flex justify-content-between" style="width: 37%">
          <p-dropdown
            [(ngModel)]="selectedStatue"
            [options]="tmpStatues"
            placeholder="Điều..."
            optionLabel="name"
            [showClear]="true"
            [style]="{ height: '35px' }"
            scrollHeight="10rem"
            [filter]="true"
            filterBy="name"
            (onChange)="selectStatue()"
            (onClear)="clearStatue()"
          ></p-dropdown>

          <p-dropdown
            id="dropdown-select-section"
            [(ngModel)]="selectedSection"
            [options]="tmpSections"
            placeholder="Khoản..."
            optionLabel="name"
            [showClear]="true"
            [style]="{ height: '35px' }"
            scrollHeight="10rem"
            [filter]="true"
            filterBy="name"
            (onChange)="selectSection()"
            (onClear)="clearSection()"
          ></p-dropdown>
        </div>
        <div class="flex justify-content-end" style="width: 63%">
          <button
            pButton
            type="button"
            label="Tạo mới"
            class="p-button-raised p-button-success"
            [style]="{ height: '40px' }"
            (click)="displayAddNewParagraph()"
          ></button>
          <!-- [disabled]="
              !(
                tmpParagraphs &&
                tmpParagraphs.length >= 1 &&
                tmpParagraphs[0].name !== '' &&
                tmpParagraphs[0].description !== ''
              )
            " -->
        </div>
      </div>
    </div>

    <div style="height: 10%" class="p-2">
      <div class="flex align-items-center">
        <div class="flex justify-content-start" style="width: 37%">
          <div class="w-full">
            <span class="p-input-icon-right mr-3 w-full">
              <i class="pi pi-search"></i>
              <input
                type="text"
                pInputText
                [disabled]="
                  !(
                    tmpParagraphs &&
                    tmpParagraphs.length >= 1 &&
                    tmpParagraphs[0].name !== '' &&
                    tmpParagraphs[0].description !== ''
                  )
                "
                placeholder="Tìm kiếm điểm..."
                [(ngModel)]="searchParagraphStr"
                [style]="{ height: '35px', width: '100%' }"
                (keyup)="filterParagraphData()"
              />
            </span>
          </div>
        </div>
      </div>
      <div class="flex">
        <div style="margin-left: 50%">
          <small class="p-error block">
            {{
              invalidFilterSectionMinPenaltyMsg ||
                invalidFilterSectionMaxPenaltyMsg
            }}
          </small>
        </div>
      </div>
    </div>

    <div style="height: 75%" class="p-2 overflow-auto">
      <span
        *ngIf="
          !(
            tmpParagraphs &&
            tmpParagraphs.length >= 1 &&
            tmpParagraphs[0].name !== '' &&
            tmpParagraphs[0].description !== ''
          ) && !searchParagraphStr
        "
        class="text-lg text-blue-500 font-bold"
      >
        {{ selectedSection?.name }} không chứa điểm.
      </span>
      <p-table
        *ngIf="
          tmpParagraphs &&
          tmpParagraphs.length >= 1 &&
          tmpParagraphs[0].name !== '' &&
          tmpParagraphs[0].description !== ''
        "
        [value]="paragraphs"
        [paginator]="paragraphs?.length > 8 ? true : false"
        [rows]="8"
        [showCurrentPageReport]="paragraphs?.length > 8 ? true : false"
        responsiveLayout="scroll"
        currentPageReportTemplate="{first} đến {last} trong tổng số {totalRecords} mục"
        styleClass="p-datatable-gridlines p-datatable-sm"
      >
        <ng-template pTemplate="header">
          <tr>
            <th [ngStyle]="{ width: '5%', 'text-align': 'center' }">#</th>
            <th [ngStyle]="{ width: '15%', 'text-align': 'center' }">Điểm</th>
            <th [ngStyle]="{ width: '40%', 'text-align': 'center' }">
              Nội dung
            </th>
            <th [ngStyle]="{ width: '17.5%', 'text-align': 'center' }">
              Bao gồm hành vi tại
            </th>
            <th [ngStyle]="{ width: '17.5%', 'text-align': 'center' }">
              Ngoại trừ hành vi tại
            </th>
            <th [ngStyle]="{ width: '5%', 'text-align': 'center' }"></th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-paragraph let-i="rowIndex">
          <tr>
            <td class="text-center">
              {{ i + 1 }}
            </td>
            <td class="text-center">
              <div
                class="w-6rem white-space-nowrap overflow-hidden text-overflow-ellipsis"
              >
                <span>{{ paragraph.name }}</span>
              </div>
            </td>
            <td class="text-center">
              <div
                class="w-17rem overflow-hidden white-space-nowrap text-overflow-ellipsis text-center"
              >
                <span>{{ paragraph.description }}</span>
              </div>
            </td>
            <td class="text-center">
              <div
                class="w-10rem overflow-hidden white-space-nowrap text-overflow-ellipsis text-center"
              >
                <span
                  *ngFor="
                    let referenceParagraph of paragraph.referenceParagraphs;
                    let last = last
                  "
                >
                  <span
                    *ngIf="!referenceParagraph.referenceParagraphIsExcluded"
                  >
                    <span
                      >{{
                        referenceParagraph.referenceParagraphSectionStatueName
                      }}*</span
                    >
                    <span
                      >{{
                        referenceParagraph.referenceParagraphSectionName
                      }}*</span
                    >
                    <span>{{ referenceParagraph.referenceParagraphName }}</span>
                    <span *ngIf="!last">; </span>
                  </span>
                </span>
              </div>
            </td>
            <td class="text-center">
              <div
                class="w-10rem overflow-hidden white-space-nowrap text-overflow-ellipsis text-center"
              >
                <span
                  *ngFor="
                    let referenceParagraph of paragraph.referenceParagraphs;
                    let last = last
                  "
                >
                  <span *ngIf="referenceParagraph.referenceParagraphIsExcluded">
                    <span
                      >{{
                        referenceParagraph.referenceParagraphSectionStatueName
                      }}*</span
                    >
                    <span
                      >{{
                        referenceParagraph.referenceParagraphSectionName
                      }}*</span
                    >
                    <span>{{ referenceParagraph.referenceParagraphName }}</span>
                    <span *ngIf="!last">; </span>
                  </span>
                </span>
              </div>
            </td>
            <td class="text-center">
              <button
                pButton
                type="button"
                icon="pi pi-info"
                class="p-button-rounded p-button-outlined btn-info"
                style="width: 25px !important; height: 25px !important"
                (click)="viewParagraphInfo(paragraph)"
              ></button>
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="6">
              <span class="font-bold">Không tìm thấy kết quả</span>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>

  <!-- Right default -->
  <div
    [ngClass]="{
      'h-full w-4 border-left-3 border-300 p-2': chosenParagraph === undefined,
      hidden: chosenParagraph
    }"
  >
    <div class="flex align-items-center mb-3">
      <i class="pi pi-info-circle text-xl"></i>
      <span class="text-xl ml-2">Thông tin</span>
    </div>

    <div id="right-default-content" class="text-lg">
      <div class="mb-3" *ngIf="paragraphs && paragraphs.length > 1">
        <span>Bạn đang quản lý các Điểm trong: </span>
      </div>

      <div class="flex mb-3">
        <div class="w-4">
          <span>Nghị định: </span>
        </div>
        <div class="w-8">
          <span> {{ decree?.name }}</span>
        </div>
      </div>

      <div class="flex mb-3">
        <div class="w-4">
          <span>Mục: </span>
        </div>
        <div class="w-8">
          <span> {{ column?.name }}</span>
        </div>
      </div>

      <div class="flex mb-3">
        <div class="w-4">
          <span>Điều: </span>
        </div>
        <div class="w-8">
          <span> {{ selectedStatue?.name }}</span>
        </div>
      </div>

      <div class="flex mb-1">
        <div class="w-4">
          <span>Khoản: </span>
        </div>
        <div class="w-8">
          <span> {{ selectedSection?.name }}</span>
        </div>
      </div>

      <div class="flex align-items-center justify-content-center mb-2">
        <div class="surface-200 w-12 border-left-2 border-400 p-2">
          {{ selectedSection?.description }}
        </div>
      </div>
    </div>

    <div>
      <div>
        <div>
          <button
            pButton
            pRipple
            type="button"
            label="Quay lại quản lý các Khoản"
            class="p-button-outlined"
            [style]="{ border: '3px solid #3B82F6', height: '40px' }"
            (click)="returnToManegeSections()"
          ></button>
        </div>
      </div>
    </div>
  </div>

  <!-- Right with chosen paragraph -->
  <div
    [ngClass]="{
      'h-full w-4 border-left-3 border-300':
        chosenParagraph && !isUpdatingChosenParagraph,
      hidden: chosenParagraph === undefined || isUpdatingChosenParagraph
    }"
  >
    <div
      class="border-bottom-3 border-300 p-2"
      [ngStyle]="{ height: isCollapsedChosenParagraph ? '10%' : '35%' }"
    >
      <div class="flex align-items-center justify-content-between text-xl mb-2">
        <div class="flex align-items-center w-6">
          <i class="pi pi-info-circle text-xl"></i>
          <span class="ml-2">Thông tin chung</span>
        </div>
        <div class="w-6 flex align-items-center justify-content-end">
          <div *ngIf="isCollapsedChosenParagraph">
            <button
              pButton
              pRipple
              type="button"
              icon="pi pi-chevron-circle-up"
              class="p-button-rounded p-button-text"
              (click)="isCollapsedChosenParagraph = false"
              style="color: black"
            ></button>
          </div>
          <div *ngIf="!isCollapsedChosenParagraph">
            <button
              pButton
              pRipple
              type="button"
              icon="pi pi-chevron-circle-down"
              class="p-button-rounded p-button-text"
              (click)="isCollapsedChosenParagraph = true"
              style="color: black"
            ></button>
          </div>
        </div>
      </div>
      <div *ngIf="!isCollapsedChosenParagraph">
        <div class="flex text-lg mb-3">
          <div class="w-4">
            <span>Nghị định: </span>
          </div>
          <div class="w-8">
            <span> {{ decree?.name }}</span>
          </div>
        </div>

        <div class="flex text-lg mb-3">
          <div class="w-4">
            <span>Mục: </span>
          </div>
          <div class="w-8">
            <span> {{ column?.name }}</span>
          </div>
        </div>

        <div class="flex text-lg mb-3">
          <div class="w-4">
            <span>Điều: </span>
          </div>
          <div class="w-8">
            <span> {{ selectedStatue?.name }}</span>
          </div>
        </div>

        <div class="flex text-lg">
          <div class="w-4">
            <span>Khoản: </span>
          </div>
          <div class="w-8">
            <span> {{ selectedSection?.name }}</span>
          </div>
        </div>
      </div>
    </div>

    <div
      class="p-2"
      [ngStyle]="{ height: isCollapsedChosenParagraph ? '90%' : '65%' }"
    >
      <div style="height: 90%" class="overflow-y-auto">
        <div class="text-xl mb-3">
          <i class="pi pi-info-circle text-xl"></i>
          <span class="ml-2">Chi tiết</span>
        </div>

        <div class="text-lg mb-2" *ngIf="chosenParagraph?.name !== ''">
          <div class="flex">
            <div class="w-4">
              <span>Điểm: </span>
            </div>
            <div class="w-8">
              <span class="font-bold text-blue-500">
                {{ chosenParagraph?.name }}</span
              >
            </div>
          </div>
        </div>

        <div class="text-lg" *ngIf="chosenParagraph?.description !== ''">
          Nội dung:
        </div>

        <div
          *ngIf="chosenParagraph?.description !== ''"
          class="text-lg mb-2 overflow-x-hidden overflow-y-auto surface-200 w-12 border-left-2 border-400"
          style="max-height: 30%"
        >
          <div class="p-2 h-full">
            {{ chosenParagraph?.description }}
          </div>
        </div>

        <div class="text-lg">Bao gồm các hành vi tại:</div>
        <div
          class="text-lg mb-2 overflow-x-hidden overflow-y-auto surface-200 w-12 border-left-2 border-400"
          style="max-height: 30%"
        >
          <div class="p-2 h-full">
            <span *ngIf="!chosenParagraph?.hasIncluded" class="text-400">
              &#123;không&#125;
            </span>
            <span
              *ngFor="
                let referenceParagraph of chosenParagraph?.referenceParagraphs;
                let last = last
              "
            >
              <span
                *ngIf="!referenceParagraph.referenceParagraphIsExcluded"
                [pTooltip]="referenceParagraph.referenceParagraphDesc"
                [escape]="false"
                tooltipPosition="top"
                class="cursor-pointer"
              >
                <span
                  >{{
                    referenceParagraph.referenceParagraphSectionStatueName
                  }}*</span
                >
                <span
                  >{{ referenceParagraph.referenceParagraphSectionName }}*</span
                >
                <span>{{ referenceParagraph.referenceParagraphName }}</span>
                <span *ngIf="!last">; <br /></span>
              </span>
            </span>
          </div>
        </div>

        <div class="text-lg">Ngoại trừ các hành vi tại:</div>
        <div
          class="text-lg mb-2 overflow-x-hidden overflow-y-auto surface-200 w-12 border-left-2 border-400"
          style="max-height: 30%"
        >
          <div class="p-2 h-full">
            <span *ngIf="!chosenParagraph?.hasExcluded" class="text-400">
              &#123;không&#125;
            </span>
            <span
              *ngFor="
                let referenceParagraph of chosenParagraph?.referenceParagraphs;
                let last = last
              "
            >
              <span
                *ngIf="referenceParagraph.referenceParagraphIsExcluded"
                [pTooltip]="referenceParagraph.referenceParagraphDesc"
                [escape]="false"
                tooltipPosition="top"
                class="cursor-pointer"
              >
                <span
                  >{{
                    referenceParagraph.referenceParagraphSectionStatueName
                  }}*</span
                >
                <span
                  >{{ referenceParagraph.referenceParagraphSectionName }}*</span
                >
                <span>{{ referenceParagraph.referenceParagraphName }}</span>
                <span *ngIf="!last">; <br /></span>
              </span>
            </span>
          </div>
        </div>

        <div class="text-lg">Hình phạt bổ sung:</div>
        <div
          class="text-lg mb-2 overflow-x-hidden overflow-y-auto surface-200 w-12 border-left-2 border-400"
          style="max-height: 30%"
        >
          <div class="p-2 h-full">
            <span *ngIf="chosenParagraph?.additionalPenalty">
              {{ chosenParagraph?.additionalPenalty }}
            </span>
            <span *ngIf="!chosenParagraph?.additionalPenalty" class="text-400">
              &#123;không&#125;
            </span>
          </div>
        </div>
      </div>
      <div style="height: 10%">
        <div class="flex">
          <div class="w-6">
            <button
              pButton
              pRipple
              type="button"
              label="Chỉnh sửa"
              class="p-button-raised p-button-warning"
              [style]="{ height: '40px' }"
              (click)="openUpdateChosenParagraph()"
            ></button>
          </div>
          <div
            class="w-6 text-right"
            *ngIf="
              chosenParagraph?.name !== '' &&
              chosenParagraph?.description !== ''
            "
          >
            <button
              pButton
              pRipple
              type="button"
              label="Bãi bỏ"
              class="p-button-raised p-button-danger"
              [style]="{ height: '40px' }"
              (click)="
                displayConfirmDeleteParagraphDialog = true; getApprovalRate()
              "
            ></button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Right for updating chosenParagraph -->
  <div
    [ngClass]="{
      'h-full w-4 border-left-3 border-300': isUpdatingChosenParagraph,
      hidden: !isUpdatingChosenParagraph
    }"
  >
    <div class="p-2 overflow-y-auto" style="height: 90%">
      <div class="flex align-items-center text-xl mb-2">
        <i class="pi pi-file-edit text-xl"></i>
        <span class="ml-2">Chỉnh sửa</span>
      </div>

      <div class="text-lg mb-2" *ngIf="chosenParagraph?.name !== ''">
        <div class="flex">
          <div class="w-4">
            <span>Điểm: </span>
          </div>
          <div class="w-8">
            <span class="font-bold text-blue-500">
              {{ chosenParagraph?.name }}</span
            >
          </div>
        </div>
      </div>

      <div class="text-lg" *ngIf="chosenParagraph?.description !== ''">
        Nội dung:
      </div>
      <div class="text-lg mb-2" *ngIf="chosenParagraph?.description !== ''">
        <!-- <div class="backdrop">
          <div class="highlights" [innerHTML]="innerHTMLHightLight"></div>
        </div> -->

        <textarea
          class="w-full h-7rem overflow-y-auto"
          [rows]="10"
          pInputTextarea
          [autoResize]="true"
          value="{{ newChosenParagraphDesc }}"
          [(ngModel)]="newChosenParagraphDesc"
          (keyup)="getUpdatedParagraphDescription($event)"
        ></textarea>
        <!-- id="para-desc-textarea" -->
      </div>
      <span class="p-error block" *ngIf="invalidChosenParagraphNewDesc"
        >Vui lòng nhập nội dung của điểm (tối đa 2000 ký tự)</span
      >

      <div class="text-lg flex align-items-center justify-content-between mb-1">
        <span>Bao gồm các hành vi tại:</span>

        <button
          pButton
          pRipple
          type="button"
          label="Thêm"
          class="p-button-primary"
          [style]="{ height: '30px' }"
          (click)="
            loadAddingChosenParagraphStatueList();
            isUpdatingChosenParagraphReferenceIncludedList = true
          "
        ></button>
      </div>
      <div
        class="text-lg border-1 border-400 border-round-sm overflow-auto max-h-5rem mb-3"
        style="min-height: 2rem; padding: 0.5rem 0 0.5rem 0"
      >
        <span
          *ngFor="
            let reference of newChosenParagraphReferenceList;
            let i = index
          "
        >
          <p-chip
            *ngIf="!reference.referenceParagraphIsExcluded"
            class="inline-block w-6"
            [style]="{ 'margin-left': '0.5rem', 'margin-bottom': '0.5rem' }"
            label="{{ reference.referenceParagraphSectionStatueName }}*{{
              reference.referenceParagraphSectionName
            }}*{{ reference.referenceParagraphName }}"
            [removable]="true"
            class="cursor-pointer"
            [pTooltip]="reference.referenceParagraphDesc"
            tooltipPosition="top"
            (onRemove)="removeChosenParagraphReferenceParagraphs(reference)"
          ></p-chip>
        </span>
      </div>

      <div class="text-lg flex align-items-center justify-content-between mb-1">
        <span>Ngoại trừ các hành vi tại:</span>

        <button
          pButton
          pRipple
          type="button"
          label="Thêm"
          class="p-button-primary"
          [style]="{ height: '30px' }"
          (click)="
            loadAddingChosenParagraphStatueList();
            isUpdatingChosenParagraphReferenceExcludedList = true
          "
        ></button>
      </div>
      <div
        class="text-lg border-1 border-400 border-round-sm overflow-auto max-h-5rem mb-3"
        style="min-height: 2rem; padding: 0.5rem 0 0.5rem 0"
      >
        <span
          *ngFor="
            let reference of newChosenParagraphReferenceList;
            let i = index
          "
        >
          <p-chip
            *ngIf="reference.referenceParagraphIsExcluded"
            class="inline-block w-6"
            [style]="{ 'margin-left': '0.5rem', 'margin-bottom': '0.5rem' }"
            label="{{ reference.referenceParagraphSectionStatueName }}*{{
              reference.referenceParagraphSectionName
            }}*{{ reference.referenceParagraphName }}"
            [removable]="true"
            class="cursor-pointer"
            [pTooltip]="reference.referenceParagraphDesc"
            tooltipPosition="top"
            (onRemove)="removeChosenParagraphReferenceParagraphs(reference)"
          ></p-chip>
        </span>
      </div>

      <div class="text-lg">Hình phạt bổ sung:</div>
      <div class="text-lg mb-2">
        <textarea
          class="w-full h-7rem overflow-y-auto"
          [rows]="10"
          pInputTextarea
          [autoResize]="true"
          value="{{ newChosenParagraphAdditionalPenalty }}"
          [(ngModel)]="newChosenParagraphAdditionalPenalty"
          (keyup)="getUpdatedParagraphAdditionalPenalty($event)"
        ></textarea>
      </div>

      <div class="text-lg mb-2 flex align-items-center">
        <div class="w-7">Sửa đổi bổ sung bởi (nếu có)</div>
        <div class="w-5 flex flex-row-reverse">
          <p-dropdown
            [options]="changingDecrees"
            optionLabel="decreeName"
            [(ngModel)]="selectedChangingDecree"
            placeholder="---------"
            [showClear]="true"
            scrollHeight="6rem"
            [filter]="true"
            filterBy="decreeName"
            [style]="{ width: '10rem', height: '35px' }"
            class="dropdown-changing-decrees"
            (onChange)="selectChangingDecreeUpdateChosenParagraph()"
          >
            <ng-template
              let-changingDecree
              pTemplate="item"
              class="dropdown-changing-decrees-tooltip"
            >
              <div
                [pTooltip]="changingDecree.decreeName"
                tooltipPosition="left"
                class="w-7rem overflow-hidden whitespace-no-wrap text-overflow-ellipsis"
                [style]="{ height: '2.5rem' }"
              >
                <span>{{ changingDecree.decreeName }}</span>
              </div>
            </ng-template>
          </p-dropdown>
        </div>
      </div>

      <div class="text-lg flex align-items-center">
        <div class="w-4">Gửi yêu cầu tới</div>
        <div class="w-8 flex flex-row-reverse">
          <p-dropdown
            [options]="admins"
            optionLabel="username"
            [(ngModel)]="selectedAdmin"
            scrollHeight="6rem"
            [filter]="true"
            filterBy="username"
            [style]="{ width: '10rem', height: '35px' }"
            class="dropdown-admins"
          >
            <ng-template
              let-admin
              pTemplate="item"
              class="dropdown-admins-tooltip"
            >
              <div
                [pTooltip]="admin.pendingRequests"
                tooltipPosition="left"
                class="w-full h-3rem flex justify-content-center align-items-center whitespace-no-wrap text-overflow-ellipsis"
              >
                <span>{{ admin.username }}</span>
              </div>
            </ng-template>
          </p-dropdown>
        </div>
      </div>
    </div>

    <div class="p-2" style="height: 10%">
      <div class="flex align-items-center">
        <div class="w-6">
          <button
            pButton
            pRipple
            type="button"
            label="Cập nhật"
            class="p-button-raised p-button-success"
            [style]="{ height: '40px' }"
            [disabled]="!isValidUpdatingParagraph"
            (click)="
              displayConfirmUpdateParagraphDialog = true; getApprovalRate()
            "
          ></button>
        </div>
        <div class="w-6 flex flex-row-reverse">
          <button
            pButton
            pRipple
            type="button"
            label="Hủy bỏ"
            class="p-button-outlined p-button-danger"
            [style]="{ border: '3px solid #EF4450', height: '40px' }"
            (click)="cancelUpdateChosenParagraph()"
          ></button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Add booth included and excuded reference paragraphs for chosen updating paragraph -->
<p-dialog
  [(visible)]="displayAddChosenParagraphReference"
  [style]="{ width: '500px', height: 'auto' }"
  (onHide)="clearAddChosenParagraphReference()"
  [modal]="true"
>
  <ng-template pTemplate="header">
    <span class="text-primary-500 font-bold text-xl">Thêm hành vi bao gồm</span>
  </ng-template>

  <div
    class="h-auto"
    [ngStyle]="{
      'padding-bottom':
        tmpChosenParagraphAddingReferenceList.length > 0 ? '4rem' : '7rem'
    }"
  >
    <div class="flex justify-content-center align-items-center mb-2">
      <div class="w-6">
        <span class="text-lg font-bold">Mời chọn điều </span> <br />
      </div>
      <div class="w-6 flex justify-content-end">
        <p-dropdown
          [options]="addingChosenParagraphStatueList"
          optionLabel="name"
          [style]="{ height: '35px', width: '9rem' }"
          placeholder="Điều..."
          scrollHeight="6rem"
          [filter]="true"
          filterBy="name"
          (onChange)="selectAddingChosenParagraphStatue($event)"
        ></p-dropdown>
      </div>
    </div>

    <div
      *ngIf="addingChosenParagraphStatue?.description"
      class="surface-200 w-12 border-left-2 border-400 p-2 mb-3 max-h-4rem overflow-auto"
    >
      {{ addingChosenParagraphStatue?.description }}
    </div>

    <div class="flex justify-content-center align-items-center mb-2">
      <div class="w-6">
        <span class="text-lg font-bold">Mời chọn khoản </span> <br />
      </div>
      <div class="w-6 flex justify-content-end">
        <p-dropdown
          [options]="addingChosenParagraphSectionList"
          optionLabel="name"
          [style]="{ height: '35px', width: '9rem' }"
          placeholder="Khoản..."
          scrollHeight="6rem"
          [filter]="true"
          filterBy="name"
          (onChange)="selectAddingChosenParagraphSection($event)"
        ></p-dropdown>
      </div>
    </div>

    <div
      *ngIf="addingChosenParagraphSection?.description"
      class="surface-200 w-12 border-left-2 border-400 p-2 mb-3 max-h-4rem overflow-auto"
    >
      {{ addingChosenParagraphSection?.description }}
    </div>

    <div
      class="flex justify-content-center align-items-center mb-2"
      *ngIf="!emptyParagraphSectionMsg"
    >
      <div class="w-6">
        <span class="text-lg font-bold">Mời chọn điểm </span> <br />
      </div>
      <div class="w-6 flex justify-content-end">
        <p-dropdown
          [options]="addingChosenParagraphParagraphList"
          optionLabel="name"
          [style]="{ height: '35px', width: '9rem' }"
          placeholder="Điểm..."
          scrollHeight="6rem"
          [filter]="true"
          filterBy="name"
          (onChange)="selectAddingChosenParagraphParagraph($event)"
        ></p-dropdown>
      </div>
    </div>

    <div
      *ngIf="addingChosenParagraphParagraph?.description"
      class="surface-200 w-12 border-left-2 border-400 p-2 max-h-4rem overflow-auto mb-2"
    >
      {{ addingChosenParagraphParagraph?.description }}
    </div>

    <div *ngIf="emptyParagraphSectionMsg" class="font-bold mb-2">
      {{ emptyParagraphSectionMsg }}
    </div>

    <hr *ngIf="tmpChosenParagraphAddingReferenceList.length > 0" />
    <div
      *ngIf="tmpChosenParagraphAddingReferenceList"
      class="max-h-6rem overflow-auto"
    >
      <div
        *ngFor="
          let reference of tmpChosenParagraphAddingReferenceList;
          let i = index
        "
      >
        <div class="flex justify-content-center align-items-center">
          {{ reference.referenceParagraphSectionStatueName }} -
          {{ reference.referenceParagraphSectionName }} -
          {{ reference.referenceParagraphName }}

          <button
            pButton
            type="button"
            icon="pi pi-times"
            class="p-button-rounded p-button-danger p-button-text"
            (click)="removeChosenParagraphIncludedReference(i)"
          ></button>
        </div>
      </div>
    </div>

    <div
      *ngIf="addingErrorChosenParagraphAddingReferenceListReferenceMsg"
      class="font-bold text-red-500 flex justify-content-center"
    >
      {{ addingErrorChosenParagraphAddingReferenceListReferenceMsg }}
    </div>
  </div>

  <ng-template pTemplate="footer">
    <div class="flex justify-content-end mb-2">
      <button
        pButton
        pRipple
        type="button"
        label="Lưu lại"
        class="p-button-outlined p-button-warning"
        [style]="{
          border: '3px solid #F59E0B',
          height: '35px',
          width: '120px'
        }"
        (click)="addChosenParagraphIncludedReference()"
      ></button>
      <!-- [disabled]="addingChosenParagraphParagraph === undefined ? true : false" -->
    </div>
    <button
      type="button"
      pButton
      label="Hủy"
      class="p-button-danger"
      style="height: 35px; width: 120px"
      (click)="clearAddChosenParagraphReference()"
    ></button>

    <button
      *ngIf="isUpdatingChosenParagraphReferenceIncludedList"
      type="button"
      pButton
      label="Hoàn thành"
      class="p-button-success"
      style="height: 35px; width: 120px"
      [disabled]="
        tmpChosenParagraphAddingReferenceList.length === 0 ? true : false
      "
      (click)="completeAddChosenParagraphIncludedReference()"
    ></button>

    <button
      *ngIf="isUpdatingChosenParagraphReferenceExcludedList"
      type="button"
      pButton
      label="Hoàn thành"
      class="p-button-success"
      style="height: 35px; width: 120px"
      [disabled]="
        tmpChosenParagraphAddingReferenceList.length === 0 ? true : false
      "
      (click)="completeAddChosenParagraphIncludedReference()"
    ></button>
  </ng-template>
</p-dialog>

<!-- Confirm update statue dialog -->
<p-dialog
  [(visible)]="displayConfirmUpdateStatueDialog"
  [style]="{ width: '30rem' }"
  [modal]="true"
>
  <ng-template pTemplate="header">
    <span class="text-orange-500 font-bold text-xl">Chỉnh sửa</span>
  </ng-template>

  <ng-template pTemplate="content">
    <div class="w-full text-center text-lg">
      <div class="w-full mb-2">
        "{{ chosenStatue?.name }}"
        <span> sẽ được gửi yêu cầu chỉnh sửa. Bạn có chắc? </span>
      </div>

      <div
        class="w-full text-left p-2 border-blue-200 border-2 border-round-md"
      >
        <span class="font-bold text-lg">Lưu ý: </span><br />
        + Tỷ lệ phê duyệt hiện tại:
        <span class="font-bold" *ngIf="totalRomCount !== 0"
          >{{
            (1 - deniedRomCount / totalRomCount) * 100 | number: "2.0-2"
          }}%</span
        >
        <span *ngIf="totalRomCount === 0" class="font-bold"
          >Chưa có dữ liệu</span
        >
        <br />
        + Tỷ lệ phê duyệt (nếu yêu cầu được chấp nhận):
        <span class="font-bold"
          >{{
            (1 - deniedRomCount / (totalRomCount + 1)) * 100 | number: "2.0-2"
          }}%</span
        ><br />
        + Tỷ lệ phê duyệt (nếu yêu cầu bị từ chối):
        <span class="font-bold"
          >{{
            (1 - (deniedRomCount + 1) / (totalRomCount + 1)) * 100
              | number: "1.0-2"
          }}%</span
        ><br />
        <div class="text-center">
          <span class="font-bold font-italic text-red-300 text-sm"
            >Nếu tỷ lệ phê duyệt < 65%, tài khoản sẽ bị ngưng hoạt động bởi hệ
            thống</span
          >
        </div>
      </div>
    </div>
  </ng-template>

  <ng-template pTemplate="footer">
    <button
      type="button"
      pButton
      icon="pi pi-times"
      label="Hủy"
      class="p-button-danger"
      style="height: 40px"
      (click)="displayConfirmUpdateStatueDialog = false"
    ></button>
    <button
      type="button"
      pButton
      icon="pi pi-check"
      label="Đồng ý"
      class="p-button-success"
      style="height: 40px"
      (click)="updateChosenStatue()"
    ></button>
  </ng-template>
</p-dialog>

<!-- Confirm delete statue dialog -->
<p-dialog
  [(visible)]="displayConfirmDeleteStatueDialog"
  [style]="{ width: '35vw' }"
  [modal]="true"
>
  <ng-template pTemplate="header">
    <span class="text-red-500 font-bold text-xl">Bãi bỏ</span>
  </ng-template>

  <div class="w-full mb-2">
    <div class="flex justify-content-center align-items-center">
      <div class="w-3">
        <span class="text-lg font-bold">Gửi yêu cầu tới </span> <br />
      </div>
      <div class="w-9 flex justify-content-end">
        <p-dropdown
          [(ngModel)]="selectedAdmin"
          [options]="admins"
          optionLabel="username"
          scrollHeight="6rem"
          [filter]="true"
          filterBy="username"
          [style]="{ height: '40px' }"
          class="dropdown-admins"
        >
          <ng-template
            let-admin
            pTemplate="item"
            class="dropdown-admins-tooltip"
          >
            <div
              [pTooltip]="admin.pendingRequests"
              tooltipPosition="left"
              class="w-full h-3rem flex justify-content-center align-items-center whitespace-no-wrap text-overflow-ellipsis"
            >
              <span>{{ admin.username }}</span>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
    </div>
  </div>
  <div class="w-full text-center mb-2">
    <span class="text-lg font-bold ml-4">
      {{ chosenStatue?.name }}
    </span>
    <span class="text-lg"> sẽ được gửi yêu cầu xóa. Bạn có chắc chắn?</span>
  </div>
  <div class="w-full text-left p-2 border-blue-200 border-2 border-round-md">
    <span class="font-bold text-lg">Lưu ý: </span><br />
    + Tỷ lệ phê duyệt hiện tại:
    <span class="font-bold" *ngIf="totalRomCount !== 0"
      >{{ (1 - deniedRomCount / totalRomCount) * 100 | number: "2.0-2" }}%</span
    >
    <span *ngIf="totalRomCount === 0" class="font-bold">Chưa có dữ liệu</span>
    <br />
    + Tỷ lệ phê duyệt (nếu yêu cầu được chấp nhận):
    <span class="font-bold"
      >{{
        (1 - deniedRomCount / (totalRomCount + 1)) * 100 | number: "2.0-2"
      }}%</span
    ><br />
    + Tỷ lệ phê duyệt (nếu yêu cầu bị từ chối):
    <span class="font-bold"
      >{{
        (1 - (deniedRomCount + 1) / (totalRomCount + 1)) * 100
          | number: "1.0-2"
      }}%</span
    ><br />
    <div class="text-center">
      <span class="font-bold font-italic text-red-300 text-sm"
        >Nếu tỷ lệ phê duyệt < 65%, tài khoản sẽ bị ngưng hoạt động bởi hệ
        thống</span
      >
    </div>
  </div>

  <ng-template pTemplate="footer">
    <button
      type="button"
      pButton
      icon="pi pi-times"
      label="Hủy"
      class="p-button-danger"
      style="height: 40px"
      (click)="displayConfirmDeleteStatueDialog = false"
    ></button>
    <button
      type="button"
      pButton
      icon="pi pi-check"
      label="Đồng ý"
      class="p-button-success"
      style="height: 40px"
      (click)="deleteChosenStatue()"
    ></button>
  </ng-template>
</p-dialog>

<!-- Confirm update section dialog -->
<p-dialog
  [(visible)]="displayConfirmUpdateSectionDialog"
  [style]="{ width: '30rem' }"
  [modal]="true"
>
  <ng-template pTemplate="header">
    <span class="text-orange-500 font-bold text-xl">Chỉnh sửa</span>
  </ng-template>
  <div class="w-full text-center text-lg mb-2">
    "{{ chosenSection?.name }}"
    <span> sẽ được gửi yêu cầu chỉnh sửa. Bạn có chắc? </span>
  </div>
  <div class="w-full text-left p-2 border-blue-200 border-2 border-round-md">
    <span class="font-bold text-lg">Lưu ý: </span><br />
    + Tỷ lệ phê duyệt hiện tại:
    <span class="font-bold" *ngIf="totalRomCount !== 0"
      >{{ (1 - deniedRomCount / totalRomCount) * 100 | number: "2.0-2" }}%</span
    >
    <span *ngIf="totalRomCount === 0" class="font-bold">Chưa có dữ liệu</span>
    <br />
    + Tỷ lệ phê duyệt (nếu yêu cầu được chấp nhận):
    <span class="font-bold"
      >{{
        (1 - deniedRomCount / (totalRomCount + 1)) * 100 | number: "2.0-2"
      }}%</span
    ><br />
    + Tỷ lệ phê duyệt (nếu yêu cầu bị từ chối):
    <span class="font-bold"
      >{{
        (1 - (deniedRomCount + 1) / (totalRomCount + 1)) * 100
          | number: "1.0-2"
      }}%</span
    ><br />
    <div class="text-center">
      <span class="font-bold font-italic text-red-300 text-sm"
        >Nếu tỷ lệ phê duyệt < 65%, tài khoản sẽ bị ngưng hoạt động bởi hệ
        thống</span
      >
    </div>
  </div>

  <ng-template pTemplate="footer">
    <button
      type="button"
      pButton
      icon="pi pi-times"
      label="Hủy"
      class="p-button-danger"
      style="height: 40px"
      (click)="displayConfirmUpdateSectionDialog = false"
    ></button>
    <button
      type="button"
      pButton
      icon="pi pi-check"
      label="Đồng ý"
      class="p-button-success"
      style="height: 40px"
      (click)="updateChosenSection()"
    ></button>
  </ng-template>
</p-dialog>

<!-- Confirm delete section dialog -->
<p-dialog
  [(visible)]="displayConfirmDeleteSectionDialog"
  [style]="{ width: '35vw' }"
  [modal]="true"
>
  <ng-template pTemplate="header">
    <span class="text-red-500 font-bold text-xl">Bãi bỏ</span>
  </ng-template>

  <div class="w-full mb-2">
    <div class="flex justify-content-center align-items-center">
      <div class="w-3">
        <span class="text-lg font-bold">Gửi yêu cầu tới </span> <br />
      </div>
      <div class="w-9 flex justify-content-end">
        <p-dropdown
          [(ngModel)]="selectedAdmin"
          [options]="admins"
          optionLabel="username"
          scrollHeight="6rem"
          [filter]="true"
          filterBy="username"
          [style]="{ height: '40px' }"
          class="dropdown-admins"
        >
          <ng-template
            let-admin
            pTemplate="item"
            class="dropdown-admins-tooltip"
          >
            <div
              [pTooltip]="admin.pendingRequests"
              tooltipPosition="left"
              class="w-full h-3rem flex justify-content-center align-items-center whitespace-no-wrap text-overflow-ellipsis"
            >
              <span>{{ admin.username }}</span>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
    </div>
  </div>
  <div class="w-full text-center mb-2">
    <span class="text-lg font-bold ml-4">
      {{ chosenSection?.name }}
    </span>
    <span class="text-lg"> sẽ được gửi yêu cầu xóa. Bạn có chắc chắn?</span>
  </div>
  <div class="w-full text-left p-2 border-blue-200 border-2 border-round-md">
    <span class="font-bold text-lg">Lưu ý: </span><br />
    + Tỷ lệ phê duyệt hiện tại:
    <span class="font-bold" *ngIf="totalRomCount !== 0"
      >{{ (1 - deniedRomCount / totalRomCount) * 100 | number: "2.0-2" }}%</span
    >
    <span *ngIf="totalRomCount === 0" class="font-bold">Chưa có dữ liệu</span>
    <br />
    + Tỷ lệ phê duyệt (nếu yêu cầu được chấp nhận):
    <span class="font-bold"
      >{{
        (1 - deniedRomCount / (totalRomCount + 1)) * 100 | number: "2.0-2"
      }}%</span
    ><br />
    + Tỷ lệ phê duyệt (nếu yêu cầu bị từ chối):
    <span class="font-bold"
      >{{
        (1 - (deniedRomCount + 1) / (totalRomCount + 1)) * 100
          | number: "1.0-2"
      }}%</span
    ><br />
    <div class="text-center">
      <span class="font-bold font-italic text-red-300 text-sm"
        >Nếu tỷ lệ phê duyệt < 65%, tài khoản sẽ bị ngưng hoạt động bởi hệ
        thống</span
      >
    </div>
  </div>

  <ng-template pTemplate="footer">
    <button
      type="button"
      pButton
      icon="pi pi-times"
      label="Hủy"
      class="p-button-danger"
      style="height: 40px"
      (click)="displayConfirmDeleteSectionDialog = false"
    ></button>
    <button
      type="button"
      pButton
      icon="pi pi-check"
      label="Đồng ý"
      class="p-button-success"
      style="height: 40px"
      (click)="deleteChosenSection()"
    ></button>
  </ng-template>
</p-dialog>

<!-- Confirm update paragraph dialog -->
<p-dialog
  [(visible)]="displayConfirmUpdateParagraphDialog"
  [style]="{ width: '30rem' }"
  [modal]="true"
>
  <ng-template pTemplate="header">
    <span class="text-orange-500 font-bold text-xl">Chỉnh sửa</span>
  </ng-template>
  <div class="w-full text-center text-lg mb-2">
    "{{ chosenParagraph?.name }}"
    <span> sẽ được gửi yêu cầu chỉnh sửa. Bạn có chắc? </span>
  </div>
  <div class="w-full text-left p-2 border-blue-200 border-2 border-round-md">
    <span class="font-bold text-lg">Lưu ý: </span><br />
    + Tỷ lệ phê duyệt hiện tại:
    <span class="font-bold" *ngIf="totalRomCount !== 0"
      >{{ (1 - deniedRomCount / totalRomCount) * 100 | number: "2.0-2" }}%</span
    >
    <span *ngIf="totalRomCount === 0" class="font-bold">Chưa có dữ liệu</span>
    <br />
    + Tỷ lệ phê duyệt (nếu yêu cầu được chấp nhận):
    <span class="font-bold"
      >{{
        (1 - deniedRomCount / (totalRomCount + 1)) * 100 | number: "2.0-2"
      }}%</span
    ><br />
    + Tỷ lệ phê duyệt (nếu yêu cầu bị từ chối):
    <span class="font-bold"
      >{{
        (1 - (deniedRomCount + 1) / (totalRomCount + 1)) * 100
          | number: "1.0-2"
      }}%</span
    ><br />
    <div class="text-center">
      <span class="font-bold font-italic text-red-300 text-sm"
        >Nếu tỷ lệ phê duyệt < 65%, tài khoản sẽ bị ngưng hoạt động bởi hệ
        thống</span
      >
    </div>
  </div>

  <ng-template pTemplate="footer">
    <button
      type="button"
      pButton
      icon="pi pi-times"
      label="Hủy"
      class="p-button-danger"
      style="height: 40px"
      (click)="displayConfirmUpdateParagraphDialog = false"
    ></button>
    <button
      type="button"
      pButton
      icon="pi pi-check"
      label="Đồng ý"
      class="p-button-success"
      style="height: 40px"
      (click)="updateChosenParagraph()"
    ></button>
  </ng-template>
</p-dialog>

<!-- Confirm delete paragraph dialog -->
<p-dialog
  [(visible)]="displayConfirmDeleteParagraphDialog"
  [style]="{ width: '35vw' }"
  [modal]="true"
>
  <ng-template pTemplate="header">
    <span class="text-red-500 font-bold text-xl">Bãi bỏ</span>
  </ng-template>

  <div class="w-full mb-2">
    <div class="flex justify-content-center align-items-center">
      <div class="w-3">
        <span class="text-lg font-bold">Gửi yêu cầu tới </span> <br />
      </div>
      <div class="w-9 flex justify-content-end">
        <p-dropdown
          [(ngModel)]="selectedAdmin"
          [options]="admins"
          optionLabel="username"
          scrollHeight="6rem"
          [filter]="true"
          filterBy="username"
          [style]="{ height: '40px' }"
          class="dropdown-admins"
        >
          <ng-template
            let-admin
            pTemplate="item"
            class="dropdown-admins-tooltip"
          >
            <div
              [pTooltip]="admin.pendingRequests"
              tooltipPosition="left"
              class="w-full h-3rem flex justify-content-center align-items-center whitespace-no-wrap text-overflow-ellipsis"
            >
              <span>{{ admin.username }}</span>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
    </div>
  </div>
  <div class="w-full text-center mb-2">
    <span class="text-lg font-bold ml-4">
      {{ chosenParagraph?.name }}
    </span>
    <span class="text-lg"> sẽ được gửi yêu cầu xóa. Bạn có chắc chắn?</span>
  </div>
  <div class="w-full text-left p-2 border-blue-200 border-2 border-round-md">
    <span class="font-bold text-lg">Lưu ý: </span><br />
    + Tỷ lệ phê duyệt hiện tại:
    <span class="font-bold" *ngIf="totalRomCount !== 0"
      >{{ (1 - deniedRomCount / totalRomCount) * 100 | number: "2.0-2" }}%</span
    >
    <span *ngIf="totalRomCount === 0" class="font-bold">Chưa có dữ liệu</span>
    <br />
    + Tỷ lệ phê duyệt (nếu yêu cầu được chấp nhận):
    <span class="font-bold"
      >{{
        (1 - deniedRomCount / (totalRomCount + 1)) * 100 | number: "2.0-2"
      }}%</span
    ><br />
    + Tỷ lệ phê duyệt (nếu yêu cầu bị từ chối):
    <span class="font-bold"
      >{{
        (1 - (deniedRomCount + 1) / (totalRomCount + 1)) * 100
          | number: "1.0-2"
      }}%</span
    ><br />
    <div class="text-center">
      <span class="font-bold font-italic text-red-300 text-sm"
        >Nếu tỷ lệ phê duyệt < 65%, tài khoản sẽ bị ngưng hoạt động bởi hệ
        thống</span
      >
    </div>
  </div>

  <ng-template pTemplate="footer">
    <button
      type="button"
      pButton
      icon="pi pi-times"
      label="Hủy"
      class="p-button-danger"
      style="height: 40px"
      (click)="displayConfirmDeleteParagraphDialog = false"
    ></button>
    <button
      type="button"
      pButton
      icon="pi pi-check"
      label="Đồng ý"
      class="p-button-success"
      style="height: 40px"
      (click)="deleteChosenParagraph()"
    ></button>
  </ng-template>
</p-dialog>

<p-toast key="updateSuccess" life="1000"></p-toast>
<p-toast key="updateError" life="1000"></p-toast>

<p-toast key="deleteSuccess" life="1000"></p-toast>
<p-toast key="deleteError" life="1000"></p-toast>

<p-toast key="createSuccess" life="1000"></p-toast>
<p-toast key="createError" life="1000"></p-toast>

<!-- Add new -> start from statue screen dialog -->
<p-dialog
  [(visible)]="displayAddNewLawDialog"
  [style]="{ width: '50vw' }"
  [modal]="true"
  (onHide)="clearAddNewAllData()"
>
  <ng-template pTemplate="content">
    <!-- body for select statue -->
    <div
      class="p-2 pb-8 h-full"
      *ngIf="
        isShowingStatueDialog &&
        !isShowingSectionDialog &&
        !isShowingParagraphDialog &&
        !isShowingConfirmAddNewLaw
      "
    >
      <div class="w-12 flex justify-content-center" style="height: 20%">
        <span class="text-2xl font-bold text-black-500 mb-4">
          Mời chọn Điều
        </span>
      </div>

      <div class="w-12 flex justify-content-center mb-3" style="height: 25%">
        <div class="w-8">
          <p-dropdown
            [(ngModel)]="selectedStatueForAddNewLaw"
            [options]="statueListForAddNewLaw"
            optionLabel="name"
            scrollHeight="7rem"
            [filter]="true"
            filterBy="name"
            modal="true"
            [style]="{ width: '100%', height: '35px' }"
            (onChange)="selectAnotherStatueOrDefaultStatueSelected()"
          >
          </p-dropdown>
        </div>
      </div>

      <div class="w-12 flex justify-content-center" style="max-height: 55%">
        <div class="w-8 h-full">
          <div
            class="surface-200 w-12 border-left-2 border-400 p-2 h-full overflow-auto"
          >
            {{ selectedStatueForAddNewLaw?.description }}
          </div>
        </div>
      </div>
    </div>

    <!-- body for select section -->
    <div
      class="p-2 h-full"
      style="padding-bottom: 5rem !important"
      *ngIf="
        !isShowingStatueDialog &&
        isShowingSectionDialog &&
        !isShowingParagraphDialog &&
        !isShowingConfirmAddNewLaw
      "
    >
      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-8 flex">
          <div class="w-6">
            <span class="text-lg">Điều: </span>
          </div>
          <div class="w-6 flex justify-content-end">
            <span class="text-lg font-bold">{{
              selectedStatueForAddNewLaw?.name
            }}</span>
          </div>
        </div>
      </div>

      <div *ngIf="!isAddedNewSection || isUpdatingNewSection">
        <div
          class="w-12 flex justify-content-center mb-1"
          *ngIf="!isCollapsedCreatNewSection && !isUpdatingNewSection"
        >
          <div class="w-8 flex justify-content-center">
            <span class="text-2xl font-bold text-black-500 mb-4">
              Mời chọn Khoản
            </span>
          </div>
        </div>

        <div
          class="w-12 flex justify-content-center mb-3"
          *ngIf="!isCollapsedCreatNewSection && !isUpdatingNewSection"
        >
          <div class="w-8">
            <p-dropdown
              [(ngModel)]="selectedSectionForAddNewLaw"
              [options]="selectedStatueForAddNewLaw.sections"
              optionLabel="name"
              scrollHeight="7rem"
              [filter]="true"
              filterBy="name"
              modal="true"
              [style]="{ width: '100%', height: '35px' }"
              (onChange)="selectAnotherSectionOrDefaultSectionSelected()"
              [disabled]="isAddedNewSection"
            >
            </p-dropdown>
          </div>
        </div>

        <div
          class="w-12 flex justify-content-center mb-3"
          *ngIf="
            !isCollapsedCreatNewSection &&
            !isUpdatingNewSection &&
            selectedSectionForAddNewLaw &&
            selectedSectionForAddNewLaw?.paragraphs?.length === 1 &&
            selectedSectionForAddNewLaw?.paragraphs[0]?.name?.trim() === '' &&
            selectedSectionForAddNewLaw?.paragraphs[0]?.description?.trim() ===
              ''
          "
        >
          <div class="w-8">
            <span class="font-bold text-red-300">
              {{ selectedSectionForAddNewLaw?.name }} là khoản không chứa điểm
            </span>
          </div>
        </div>

        <div *ngIf="isCollapsedCreatNewSection && !isUpdatingNewSection">
          <div class="w-12 flex justify-content-center mb-1">
            <div class="w-8 flex justify-content-center">
              <span class="text-2xl font-bold text-black-500 mb-3">
                Tạo mới khoản
              </span>
            </div>
          </div>
        </div>

        <div *ngIf="isUpdatingNewSection">
          <div class="w-12 flex justify-content-center">
            <div class="w-8 flex">
              <div class="w-6 mb-3">
                <span class="text-xl font-bold text-black-500">
                  Cập nhật {{ newSection?.name }}
                </span>
              </div>
              <div class="w-6 flex justify-content-end mb-2">
                <button
                  pButton
                  pRipple
                  type="button"
                  [disabled]="
                    newSection.description !== '' &&
                    newSection.minPenalty &&
                    newSection.maxPenalty &&
                    isValidNewSectionMinPenalty &&
                    isValidNewSectionMaxPenalty
                      ? false
                      : true
                  "
                  label="Lưu"
                  [style]="{ height: '35px', border: '3px solid' }"
                  class="p-button-success p-button-outlined mr-2"
                  (click)="saveUpdatedNewSection()"
                ></button>

                <button
                  pButton
                  pRipple
                  type="button"
                  label="Hủy"
                  [style]="{ height: '35px', border: '3px solid' }"
                  class="p-button-danger p-button-outlined mr-2"
                  (click)="cancleUpdatedNewSection()"
                ></button>
              </div>
            </div>
          </div>
        </div>

        <div
          class="w-12 flex justify-content-center mb-2"
          *ngIf="!isUpdatingNewSection"
        >
          <div class="w-8 flex">
            <div class="w-6 text-lg font-bold text-black-300">
              <span *ngIf="!isCollapsedCreatNewSection">hoặc</span>
            </div>
            <div class="w-6 flex justify-content-end">
              <button
                *ngIf="!isCollapsedCreatNewSection"
                pButton
                pRipple
                type="button"
                label="Tạo mới Khoản"
                [style]="{ height: '35px', border: '3px solid' }"
                class="p-button-outlined"
                [disabled]="isAddedNewSection"
                (click)="
                  isCollapsedCreatNewSection = true;
                  isValidGoNextOnSectionDialog = false;
                  isAddedNewSection = false
                "
              ></button>

              <button
                *ngIf="isCollapsedCreatNewSection"
                pButton
                pRipple
                type="button"
                label="Thêm"
                [disabled]="
                  newSection.description !== undefined &&
                  newSection.description !== '' &&
                  newSectionDescriptionInvalidMsg === '' &&
                  newSection.minPenalty &&
                  newSection.maxPenalty &&
                  isValidNewSectionMinPenalty &&
                  isValidNewSectionMaxPenalty
                    ? false
                    : true
                "
                [style]="{ height: '35px', border: '3px solid' }"
                class="p-button-success p-button-outlined mr-2"
                (click)="addNewSectionDataToSectionList()"
              ></button>

              <button
                *ngIf="isCollapsedCreatNewSection"
                pButton
                pRipple
                type="button"
                label="Hủy"
                [style]="{ height: '35px', border: '3px solid' }"
                class="p-button-danger p-button-outlined"
                (click)="clearNewSection()"
              ></button>
            </div>
          </div>
        </div>

        <div *ngIf="isCollapsedCreatNewSection || isUpdatingNewSection">
          <div class="w-12 flex justify-content-center mb-3">
            <div class="w-8 flex">
              <div class="w-6">
                <span class="text-lg">Khoản: </span>
              </div>
              <div class="w-6 flex justify-content-end">
                <span class="text-lg font-bold">{{ newSection?.name }}</span>
              </div>
            </div>
          </div>

          <div class="w-12 flex justify-content-center">
            <div class="w-8">
              <div class="w-6">
                <span class="text-lg">Nội dung : </span>
              </div>
            </div>
          </div>

          <div class="w-12 flex justify-content-center">
            <div class="w-8">
              <textarea
                [(ngModel)]="newSection.description"
                class="w-full h-4rem overflow-y-auto"
                [rows]="10"
                pInputTextarea
                placeholder="Nội dung..."
                (keyup)="getNewSectionName($event)"
              ></textarea>
            </div>
          </div>
          <div class="w-12 flex justify-content-center mb-3">
            <div class="w-8">
              <small
                class="p-error block"
                *ngIf="newSectionDescriptionInvalidMsg"
              >
                {{ newSectionDescriptionInvalidMsg }}
              </small>
            </div>
          </div>

          <div class="w-12 flex justify-content-center align-items-center mb-3">
            <div class="w-8 flex">
              <div class="w-6">
                <span class="text-lg">Phương tiện : </span>
              </div>
              <div class="w-6 flex justify-content-end">
                <p-dropdown
                  [(ngModel)]="newSection.vehicleCategoryId"
                  [options]="vehicleCats"
                  optionLabel="name"
                  optionValue="id"
                  placeholder="Phương tiện..."
                  [style]="{ height: '35px', width: '13rem' }"
                  scrollHeight="6rem"
                  [filter]="true"
                  filterBy="name"
                  (onChange)="changeNewSectionVehicleCat($event)"
                ></p-dropdown>
              </div>
            </div>
          </div>

          <div class="w-12 flex justify-content-center">
            <div class="w-8">
              <div class="w-6">
                <span class="text-lg">Mức phạt : </span>
              </div>
            </div>
          </div>
          <div class="w-12 flex justify-content-center mb-4">
            <div class="w-8 flex">
              <div class="w-6">
                <p-inputNumber
                  [(ngModel)]="newSection.minPenalty"
                  [ngClass]="{
                    'ng-invalid ng-dirty': !isValidNewSectionMinPenalty
                  }"
                  inputId="integeronly"
                  inputId="minmax"
                  [min]="50000"
                  [max]="75000000"
                  placeholder="Mức phạt tối thiểu..."
                  [style]="{ height: '35px', width: '13rem' }"
                  (onInput)="checkNewSectionMinPenalty($event)"
                >
                </p-inputNumber>
              </div>
              <div class="w-6 flex justify-content-end">
                <p-inputNumber
                  [(ngModel)]="newSection.maxPenalty"
                  [ngClass]="{
                    'ng-invalid ng-dirty': !isValidNewSectionMaxPenalty
                  }"
                  inputId="integeronly"
                  inputId="mixmax"
                  [min]="50000"
                  [max]="75000000"
                  placeholder="Mức phạt tối đa..."
                  [style]="{ height: '35px', width: '13rem' }"
                  (onInput)="checkNewSectionMaxPenalty($event)"
                ></p-inputNumber>
              </div>
            </div>
          </div>

          <div
            class="w-12 flex justify-content-center mb-4"
            *ngIf="newSectionPenaltyInvalidMsg"
          >
            <span class="p-error block">{{ newSectionPenaltyInvalidMsg }}</span>
          </div>

          <div class="w-12 flex justify-content-center mb-2">
            <div class="w-8">
              <p-checkbox
                class="text-lg"
                [(ngModel)]="isSectionWithNoParagraph"
                [binary]="true"
                label="Đây là khoản không chứa điểm"
                (onChange)="
                  toggleIsSectionWithNoParagraph(isSectionWithNoParagraph)
                "
              ></p-checkbox>
            </div>
          </div>

          <div *ngIf="isSectionWithNoParagraph">
            <div class="w-12 flex justify-content-center mb-3">
              <div class="w-8">
                <span class="font-bold text-orange-500"
                  >Lưu ý: Bạn sẽ không được thực hiện các thao tác thêm điểm cho
                  khoản này</span
                >
              </div>
            </div>

            <div class="w-12 flex justify-content-center mb-3">
              <div class="w-8 flex">
                <div class="w-6">
                  <span class="text-lg">Các hành vi liên quan (nếu có): </span>
                </div>
              </div>
            </div>

            <div class="w-12 flex justify-content-center mb-2">
              <div class="w-8 flex">
                <div class="w-4 flex justify-content-start">
                  <p-dropdown
                    [(ngModel)]="
                      newSectionWithNoParagraphReferenceSelectedStatue
                    "
                    [options]="newSectionWithNoParagraphReferenceStatueList"
                    optionLabel="name"
                    [style]="{ height: '35px', width: '8rem' }"
                    placeholder="Điều..."
                    scrollHeight="6rem"
                    [filter]="true"
                    filterBy="name"
                    (onChange)="selectStatueReferenceForNewSection($event)"
                  ></p-dropdown>
                </div>
                <div class="w-4 flex justify-content-center">
                  <p-dropdown
                    [(ngModel)]="
                      newSectionWithNoParagraphReferenceSelectedSection
                    "
                    [options]="newSectionWithNoParagraphReferenceSectionList"
                    optionLabel="name"
                    [style]="{ height: '35px', width: '9rem' }"
                    placeholder="Khoản..."
                    scrollHeight="6rem"
                    [filter]="true"
                    filterBy="name"
                    (onChange)="selectSectionReferenceForNewSection($event)"
                  ></p-dropdown>
                </div>
                <div class="w-4 flex justify-content-end">
                  <p-dropdown
                    [(ngModel)]="
                      newSectionWithNoParagraphReferenceSelectedParagraph
                    "
                    [options]="newSectionWithNoParagraphReferenceParagraphList"
                    optionLabel="name"
                    [style]="{ height: '35px', width: '8rem' }"
                    placeholder="Điểm..."
                    scrollHeight="6rem"
                    [filter]="true"
                    filterBy="name"
                    (onChange)="selectParagraphReferenceForNewSection($event)"
                  ></p-dropdown>
                </div>
              </div>
            </div>

            <div
              class="w-12 flex justify-content-center align-items-center mb-5"
            >
              <div class="w-8 flex align-items-center">
                <div class="w-10 flex">
                  <div class="w-6 flex">
                    <div class="p-field-radiobutton">
                      <p-radioButton
                        [value]="false"
                        [(ngModel)]="
                          tmpReferenceNewSectionWithNoParagraphIsExcluded
                        "
                        inputId="isIncluded"
                        (onClick)="
                          chooseNewSectionWithNoParagraphIncludedExcluded(
                            $event
                          )
                        "
                      ></p-radioButton>
                      <label for="isIncluded" class="ml-2"
                        >Hành vi bao gồm</label
                      >
                    </div>
                  </div>
                  <div class="w-6 flex">
                    <div class="p-field-radiobutton">
                      <p-radioButton
                        [value]="true"
                        [(ngModel)]="
                          tmpReferenceNewSectionWithNoParagraphIsExcluded
                        "
                        inputId="isExcluded"
                        (onClick)="
                          chooseNewSectionWithNoParagraphIncludedExcluded(
                            $event
                          )
                        "
                      ></p-radioButton>
                      <label for="isExcluded" class="ml-2"
                        >Hành vi ngoại trừ</label
                      >
                    </div>
                  </div>
                </div>
                <div class="w-2 flex justify-content-end">
                  <div class="w-12">
                    <button
                      pButton
                      pRipple
                      type="button"
                      label="Thêm"
                      [disabled]="
                        newSectionWithNoParagraphReferenceSelectedStatue &&
                        newSectionWithNoParagraphReferenceSelectedSection &&
                        newSectionWithNoParagraphReferenceSelectedParagraph &&
                        tmpReferenceNewSectionWithNoParagraph?.referenceParagraphIsExcluded !==
                          undefined
                          ? false
                          : true
                      "
                      [style]="{ height: '35px', border: '3px solid' }"
                      class="p-button-success p-button-outlined mr-2"
                      (click)="addNewSectionReference()"
                    ></button>
                  </div>
                </div>
              </div>
            </div>

            <div class="w-12 flex justify-content-center mb-2">
              <div class="w-8 h-7rem overflow-y-auto">
                <div
                  *ngFor="
                    let newReference of tmpReferenceListOfNewSectionWithNoParagraph;
                    let i = index
                  "
                  class="flex align-items-center ml-8"
                >
                  <span>
                    {{ newReference.referenceParagraphSectionStatueName }} *
                    {{ newReference.referenceParagraphSectionName }} *
                    {{ newReference.referenceParagraphName }}
                  </span>
                  <span
                    *ngIf="newReference?.referenceParagraphIsExcluded"
                    class="text-blue-300"
                    >&nbsp;(ngoại trừ)
                  </span>
                  <span
                    *ngIf="!newReference?.referenceParagraphIsExcluded"
                    class="text-orange-300"
                    >&nbsp;(bao gồm)
                  </span>
                  <button
                    pButton
                    type="button"
                    icon="pi pi-times"
                    class="p-button-rounded p-button-danger p-button-text"
                    (click)="removeNewSectionReference(i)"
                  ></button>
                </div>
              </div>
            </div>

            <div
              class="w-12 flex justify-content-center"
              *ngIf="!isValidAddReferenceToNewSectionWithNoParagraph"
            >
              <div class="w-8 flex justify-content-center">
                <span class="font-bold text-red-400"
                  >Điểm đã tồn tại trong danh sách</span
                >
              </div>
            </div>
          </div>
        </div>
      </div>

      <div *ngIf="isAddedNewSection && !isUpdatingNewSection">
        <div class="w-12 flex justify-content-center">
          <div class="w-8 flex align-items-center">
            <div class="w-6">
              <span class="text-lg"> Khoản </span>
            </div>
            <div class="w-6 flex justify-content-end align-items-center">
              <span class="text-lg font-bold">{{
                selectedSectionForAddNewLaw?.name
              }}</span>
              <button
                pButton
                pRipple
                type="button"
                icon="pi pi-file-edit"
                class="p-button-rounded p-button-text"
                (click)="openUpdateNewSection()"
              ></button>
              <button
                pButton
                rRipple
                type="button"
                icon="pi pi-trash"
                class="p-button-rounded p-button-danger p-button-text"
                (click)="confirmDeleteNewSection()"
              ></button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- body for create new paragraphs -->
    <div
      class="p-2 h-full"
      *ngIf="
        !isShowingStatueDialog &&
        !isShowingSectionDialog &&
        isShowingParagraphDialog &&
        !isShowingConfirmAddNewLaw
      "
    >
      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-8 flex">
          <div class="w-6">
            <span class="text-lg">Điều: </span>
          </div>
          <div class="w-6 flex justify-content-end">
            <span class="text-lg font-bold">{{
              selectedStatueForAddNewLaw?.name
            }}</span>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-8 flex">
          <div class="w-6">
            <span class="text-lg">Khoản: </span>
          </div>
          <div class="w-6 flex justify-content-end">
            <span class="text-lg font-bold">{{
              selectedSectionForAddNewLaw?.name
            }}</span>
          </div>
        </div>
      </div>

      <div
        class="w-12 flex justify-content-center"
        *ngIf="
          newParagraphListOfSelectedSection &&
          newParagraphListOfSelectedSection.length > 0 &&
          !isUpdatingNewParagraph
        "
      >
        <div class="w-8">
          <span class="text-lg">Điểm: </span>
        </div>
      </div>
      <div
        class="w-12 flex justify-content-center"
        *ngIf="
          !isUpdatingNewParagraph &&
          newParagraphListOfSelectedSection &&
          newParagraphListOfSelectedSection.length > 0
        "
      >
        <div class="w-8 max-h-5rem overflow-auto">
          <ul>
            <li
              *ngFor="
                let newParagraph of newParagraphListOfSelectedSection;
                let i = index
              "
              class="flex align-items-center"
            >
              <div class="w-3">
                <fa-icon
                  class="mr-2 fa-2xs"
                  [icon]="['fas', 'circle']"
                ></fa-icon>
                {{ newParagraph?.name }} )
              </div>
              <div
                class="w-6 overflow-hidden white-space-nowrap text-overflow-ellipsis"
              >
                {{ newParagraph?.description }}
              </div>
              <div class="w-3 flex justify-content-end">
                <button
                  pButton
                  pRipple
                  type="button"
                  icon="pi pi-file-edit"
                  class="p-button-rounded p-button-text"
                  (click)="openUpdateNewSectionParagraph(i)"
                ></button>
                <button
                  pButton
                  rRipple
                  type="button"
                  icon="pi pi-trash"
                  class="p-button-rounded p-button-danger p-button-text"
                  (click)="confirmDeleteNewParagraphInNewParagraphList(i)"
                ></button>
              </div>
            </li>
          </ul>
        </div>
      </div>

      <div
        class="w-12 flex justify-content-center"
        *ngIf="
          !isUpdatingNewParagraph &&
          newParagraphListOfSelectedSection &&
          newParagraphListOfSelectedSection.length > 0
        "
      >
        <hr class="w-6 border-top-1" />
      </div>

      <div
        class="w-12 flex justify-content-center mb-1"
        *ngIf="!isUpdatingNewParagraph"
      >
        <div class="w-8 flex justify-content-center">
          <span class="text-2xl font-bold text-black-500 mb-3">
            Tạo mới Điểm
          </span>
          <span
            class="text-2xl font-bold text-black-500 mb-3"
            *ngIf="isUpdatingNewParagraph"
          >
            Cập nhật Điểm
          </span>
        </div>
      </div>

      <div
        class="w-12 flex justify-content-center mb-1"
        *ngIf="isUpdatingNewParagraph"
      >
        <div class="w-8 flex justify-content-center mb-3">
          <div class="w-6">
            <span class="text-xl font-bold text-black-500">
              Cập nhật
              {{
                newParagraphListOfSelectedSection[updatingParagraphIndex]?.name
              }}
            </span>
          </div>
          <div class="w-6 flex justify-content-end">
            <button
              pButton
              pRipple
              type="button"
              label="Lưu"
              [disabled]="!isValidSaveNewParagraph"
              [style]="{ height: '35px', border: '3px solid' }"
              class="p-button-success p-button-outlined mr-2"
              (click)="saveUpdatedNewParagraph()"
            ></button>

            <button
              pButton
              pRipple
              type="button"
              label="Hủy"
              [style]="{ height: '35px', border: '3px solid' }"
              class="p-button-danger p-button-outlined mr-2"
              (click)="cancleUpdatedNewParagraph()"
            ></button>
          </div>
        </div>
      </div>

      <div
        class="w-12 flex justify-content-center mb-3"
        *ngIf="!isUpdatingNewParagraph"
      >
        <div class="w-8 flex">
          <div class="w-6">
            <span class="text-lg">Điểm: </span>
          </div>
          <div class="w-6 flex justify-content-end">
            <span class="text-lg font-bold">
              {{ newParagraphOfSelectedSection?.name }}
            </span>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center">
        <div class="w-8">
          <div class="w-6">
            <span class="text-lg">Nội dung : </span>
          </div>
        </div>
      </div>
      <div class="w-12 flex justify-content-center">
        <div class="w-8">
          <textarea
            [(ngModel)]="newParagraphOfSelectedSectionDescription"
            class="w-full h-4rem overflow-y-auto"
            [rows]="10"
            pInputTextarea
            placeholder="Nội dung..."
            (keyup)="getNewParagraphDescription($event)"
          ></textarea>
        </div>
      </div>
      <div class="w-12 flex justify-content-center mb-3">
        <div class="w-8">
          <span class="p-error block" *ngIf="newParagraphDescriptionInvalidMsg">
            {{ newParagraphDescriptionInvalidMsg }}
          </span>
        </div>
      </div>

      <div class="w-12 flex justify-content-center">
        <div class="w-8">
          <div class="w-6">
            <span class="text-lg">Hình phạt bổ sung (nếu có) : </span>
          </div>
        </div>
      </div>
      <div class="w-12 flex justify-content-center mb-3">
        <div class="w-8">
          <textarea
            [(ngModel)]="newParagraphOfSelectedSectionAdditionalPenalty"
            class="w-full h-4rem overflow-y-auto"
            [rows]="10"
            pInputTextarea
            placeholder="Hình phạt bổ sung..."
            (keyup)="getNewParagraphAdditionalPenalty($event)"
          ></textarea>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-3">
        <div class="w-8">
          <span
            class="p-error block"
            *ngIf="newParagraphAdditionalPenaltyInvalidMsg"
          >
            {{ newParagraphAdditionalPenaltyInvalidMsg }}
          </span>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-3">
        <div class="w-8 flex align-items-center">
          <div class="w-6">
            <span class="text-lg">Thuộc nhóm từ khóa (nếu có): </span>
          </div>
          <div class="w-6 flex justify-content-end">
            <p-dropdown
              id="new-paragraph-dropdown-keywords"
              [(ngModel)]="newParagraphSelectedKeyword"
              [options]="newParagraphKeywordList"
              optionLabel="name"
              [style]="{ height: '35px', width: '14rem' }"
              placeholder="Nhóm từ khóa..."
              scrollHeight="6rem"
              [filter]="true"
              filterBy="name"
              [showClear]="true"
              (onChange)="selectKeywordForNewParagraph($event)"
            ></p-dropdown>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-3">
        <div class="w-8 flex">
          <div class="w-6 text-lg">Sửa đổi bổ sung bởi (nếu có)</div>
          <div class="w-6 text-lg flex justify-content-end">
            <p-dropdown
              [disabled]="!newParagraphOfSelectedSectionDescription"
              [options]="changingDecrees"
              optionLabel="decreeName"
              [(ngModel)]="selectedChangingDecree"
              placeholder="---------"
              [showClear]="true"
              scrollHeight="6rem"
              [filter]="true"
              filterBy="decreeName"
              [style]="{ width: '14rem', height: '35px' }"
              class="dropdown-changing-decrees"
              (onChange)="selectChangingDecreeForAddingNewParagraph()"
            >
              <ng-template
                let-changingDecree
                pTemplate="item"
                class="dropdown-changing-decrees-tooltip"
              >
                <div
                  [pTooltip]="changingDecree.decreeName"
                  tooltipPosition="left"
                  class="w-7rem overflow-hidden whitespace-no-wrap text-overflow-ellipsis"
                  [style]="{ height: '2.5rem' }"
                >
                  <span>{{ changingDecree.decreeName }}</span>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-3">
        <div class="w-8 flex">
          <div class="w-6">
            <span class="text-lg">Các hành vi liên quan (nếu có): </span>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-8 flex">
          <div class="w-4 flex justify-content-start">
            <p-dropdown
              [(ngModel)]="newParagraphReferenceSelectedStatue"
              [options]="newParagraphReferenceStatueList"
              optionLabel="name"
              [style]="{ height: '35px', width: '8rem' }"
              placeholder="Điều..."
              scrollHeight="6rem"
              [filter]="true"
              filterBy="name"
              (onChange)="selectStatueReferenceForNewParagraph($event)"
            ></p-dropdown>
          </div>
          <div class="w-4 flex justify-content-center">
            <p-dropdown
              [(ngModel)]="newParagraphReferenceSelectedSection"
              [options]="newParagraphReferenceSectionList"
              optionLabel="name"
              [style]="{ height: '35px', width: '9rem' }"
              placeholder="Khoản..."
              scrollHeight="6rem"
              [filter]="true"
              filterBy="name"
              (onChange)="selectSectionReferenceForNewParagraph($event)"
            ></p-dropdown>
          </div>
          <div class="w-4 flex justify-content-end">
            <p-dropdown
              [(ngModel)]="newParagraphReferenceSelectedParagraph"
              [options]="newParagraphReferenceParagraphList"
              optionLabel="name"
              [style]="{ height: '35px', width: '8rem' }"
              placeholder="Điểm..."
              scrollHeight="6rem"
              [filter]="true"
              filterBy="name"
              (onChange)="selectParagraphReferenceForNewParagraph($event)"
            ></p-dropdown>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center align-items-center mb-2">
        <div class="w-8 flex align-items-center">
          <div class="w-10 flex">
            <div class="w-6 flex">
              <div class="p-field-radiobutton">
                <p-radioButton
                  [value]="false"
                  [(ngModel)]="tmpReferenceOfNewParagraphIsExcluded"
                  inputId="isIncluded"
                  (onClick)="chooseNewParagraphIncludedExcluded($event)"
                ></p-radioButton>
                <label for="isIncluded" class="ml-2">Hành vi bao gồm</label>
              </div>
            </div>
            <div class="w-6 flex">
              <div class="p-field-radiobutton">
                <p-radioButton
                  [value]="true"
                  [(ngModel)]="tmpReferenceOfNewParagraphIsExcluded"
                  inputId="isExcluded"
                  (onClick)="chooseNewParagraphIncludedExcluded($event)"
                ></p-radioButton>
                <label for="isExcluded" class="ml-2">Hành vi ngoại trừ</label>
              </div>
            </div>
          </div>
          <div class="w-2 flex justify-content-end">
            <div class="w-12">
              <button
                pButton
                pRipple
                type="button"
                label="Thêm"
                [disabled]="
                  newParagraphReferenceSelectedStatue &&
                  newParagraphReferenceSelectedSection &&
                  newParagraphReferenceSelectedParagraph &&
                  tmpReferenceOfNewParagraph.referenceParagraphIsExcluded !==
                    undefined
                    ? false
                    : true
                "
                [style]="{ height: '35px', border: '3px solid' }"
                class="p-button-success p-button-outlined mr-2"
                (click)="addNewParagraphReferenceToTmpReferenceList()"
              ></button>
            </div>
          </div>
        </div>
      </div>

      <div
        class="w-12 flex justify-content-center mb-2"
        *ngIf="!isValidAddReferenceToNewParagraph"
      >
        <div class="w-8 flex justify-content-center">
          <span class="font-bold text-red-400"
            >Điểm đã tồn tại trong danh sách</span
          >
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-8 h-7rem overflow-y-auto">
          <div
            *ngFor="
              let newReference of tmpReferenceListOfNewParagraph;
              let i = index
            "
            class="flex align-items-center ml-8"
          >
            <span>
              {{ newReference.referenceParagraphSectionStatueName }} *
              {{ newReference.referenceParagraphSectionName }} *
              {{ newReference.referenceParagraphName }}
            </span>
            <span
              *ngIf="newReference?.referenceParagraphIsExcluded"
              class="text-blue-300"
              >&nbsp;(ngoại trừ)
            </span>
            <span
              *ngIf="!newReference?.referenceParagraphIsExcluded"
              class="text-orange-300"
              >&nbsp;(bao gồm)
            </span>
            <button
              pButton
              type="button"
              icon="pi pi-times"
              class="p-button-rounded p-button-danger p-button-text"
              (click)="removeNewParagraphReference(i)"
            ></button>
          </div>
        </div>
      </div>
    </div>

    <!-- body for confirm create law -->
    <div class="p-2 h-full" *ngIf="isShowingConfirmAddNewLaw">
      <div class="w-12 flex justify-content-center mb-4">
        <div class="w-8 flex justify-content-center">
          <span class="text-2xl font-bold mb-3">Tạo mới luật</span>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-10">
          <span
            class="text-xl text-700"
            *ngIf="
              !isAddedNewSection ||
              (isAddedNewSection &&
                !selectedSectionForAddNewLaw?.isSectionWithNoParagraph)
            "
            >Xác nhận tạo mới những Điểm sau:
          </span>
          <span
            class="text-xl text-700"
            *ngIf="
              isAddedNewSection &&
              selectedSectionForAddNewLaw?.isSectionWithNoParagraph
            "
            >Xác nhận tạo mới Khoản sau:
          </span>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-8 flex">
          <div class="w-6"><span class="text-lg">Gửi yêu cầu tới:</span></div>
          <div class="w-6 flex justify-content-end">
            <p-dropdown
              [options]="admins"
              optionLabel="username"
              [(ngModel)]="selectedAdmin"
              scrollHeight="6rem"
              [filter]="true"
              filterBy="username"
              [style]="{ width: '10rem', height: '35px' }"
              class="dropdown-admins"
            >
              <ng-template
                let-admin
                pTemplate="item"
                class="dropdown-admins-tooltip"
              >
                <div
                  [pTooltip]="admin.pendingRequests"
                  tooltipPosition="left"
                  class="w-full h-3rem flex justify-content-center align-items-center whitespace-no-wrap text-overflow-ellipsis"
                >
                  <span>{{ admin.username }}</span>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-8 flex align-items-center">
          <div class="w-6">
            <span class="text-lg">Điều: </span>
          </div>
          <div class="w-6 flex justify-content-end">
            <span class="text-lg font-bold">{{
              selectedStatueForAddNewLaw?.name
            }}</span>
          </div>
        </div>
      </div>

      <div
        *ngIf="
          !isAddedNewSection ||
          (isAddedNewSection &&
            !selectedSectionForAddNewLaw?.isSectionWithNoParagraph)
        "
        class="mb-2"
      >
        <div class="w-12 flex justify-content-center">
          <div class="w-8 flex align-items-center">
            <div class="w-6">
              <span class="text-lg">Khoản: </span>
            </div>
            <div class="w-6 flex justify-content-end">
              <span class="text-lg font-bold">{{
                selectedSectionForAddNewLaw?.name
              }}</span>
            </div>
          </div>
        </div>

        <div class="w-12 flex justify-content-center mb-2">
          <div class="w-8 align-items-center">
            <div class="w-6">
              <span class="text-lg">Điểm: </span>
            </div>
          </div>
        </div>

        <div class="w-12 flex justify-content-center">
          <div class="w-8 p-3max-h-8rem overflow-y-auto overflow-x-hidden">
            <ul *ngFor="let newParagraph of newParagraphListOfSelectedSection">
              <li class="flex align-items-center">
                <div class="w-3">
                  <fa-icon
                    class="mr-2 fa-2xs"
                    [icon]="['fas', 'circle']"
                  ></fa-icon>
                  {{ newParagraph?.name }} )
                </div>
                <div
                  class="w-9 overflow-hidden white-space-nowrap text-overflow-ellipsis"
                >
                  <span>{{ newParagraph?.description }}</span>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div
        *ngIf="
          isAddedNewSection &&
          selectedSectionForAddNewLaw?.isSectionWithNoParagraph
        "
        class="mb-2"
      >
        <div class="w-12 flex justify-content-center">
          <div class="w-8 flex align-items-center">
            <div class="w-6">
              <span class="text-lg">Khoản: </span>
            </div>
            <div class="w-6 flex justify-content-end">
              <span class="text-lg">{{
                selectedSectionForAddNewLaw?.name
              }}</span>
            </div>
          </div>
        </div>

        <div class="w-12 flex justify-content-center">
          <div class="w-8">
            <div
              class="surface-200 w-12 border-left-2 border-400 p-2 w-12 max-h-5rem overflow-y-auto overflow-x-hidden"
            >
              {{ selectedSectionForAddNewLaw?.description }}
            </div>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center">
        <div class="w-8 text-left p-2 border-blue-200 border-2 border-round-md">
          <span class="font-bold text-lg">Lưu ý: </span><br />
          + Tỷ lệ phê duyệt hiện tại:
          <span class="font-bold" *ngIf="totalRomCount !== 0"
            >{{
              (1 - deniedRomCount / totalRomCount) * 100 | number: "2.0-2"
            }}%</span
          >
          <span *ngIf="totalRomCount === 0" class="font-bold"
            >Chưa có dữ liệu</span
          >
          <br />
          + Tỷ lệ phê duyệt (nếu yêu cầu được chấp nhận):
          <span class="font-bold"
            >{{
              (1 - deniedRomCount / (totalRomCount + 1)) * 100
                | number: "2.0-2"
            }}%</span
          ><br />
          + Tỷ lệ phê duyệt (nếu yêu cầu bị từ chối):
          <span class="font-bold"
            >{{
              (1 - (deniedRomCount + 1) / (totalRomCount + 1)) * 100
                | number: "1.0-2"
            }}%</span
          ><br />
          <div class="text-center">
            <span class="font-bold font-italic text-red-300 text-sm"
              >Nếu tỷ lệ phê duyệt < 65%, tài khoản sẽ bị ngưng hoạt động bởi hệ
              thống</span
            >
          </div>
        </div>
      </div>
    </div>
  </ng-template>

  <ng-template pTemplate="footer">
    <!-- footer for select statue -->
    <div
      class="p-2"
      *ngIf="
        isShowingStatueDialog &&
        !isShowingSectionDialog &&
        !isShowingParagraphDialog &&
        !isShowingConfirmAddNewLaw
      "
    >
      <div
        class="w-full flex justify-content-center"
        *ngIf="selectedStatueForAddNewLaw"
      >
        <div class="w-8 flex">
          <div class="w-6 flex justify-content-start">
            <button
              type="button"
              pButton
              label="Quay lại"
              [disabled]="true"
              class="p-button-outlined"
              style="height: 40px; margin: 0 0.5rem 0 0; border: 3px solid"
            ></button>

            <button
              type="button"
              pButton
              label="Kế tiếp"
              class="p-button-primary"
              style="height: 40px; margin: 0"
              (click)="
                selectAnotherStatueOrDefaultStatueSelected();
                isShowingStatueDialog = false;
                isShowingSectionDialog = true;
                isShowingParagraphDialog = false
              "
            ></button>
            <!-- loadSectionListForSelectedStatueInAddnewDialog(); -->
          </div>

          <div class="w-6 flex justify-content-end">
            <button
              type="button"
              pButton
              label="Hoàn thành"
              [disabled]="true"
              class="p-button-outlined p-button-success"
              style="height: 40px; margin: 0; border: 3px solid"
            ></button>
          </div>
        </div>
      </div>
    </div>

    <!-- footer for select section -->
    <div
      class="p-2"
      *ngIf="
        !isShowingStatueDialog &&
        isShowingSectionDialog &&
        !isShowingParagraphDialog &&
        !isShowingConfirmAddNewLaw
      "
    >
      <div
        class="w-full flex justify-content-center"
        *ngIf="selectedStatueForAddNewLaw"
      >
        <div class="w-8 flex">
          <div class="w-6 flex justify-content-start">
            <button
              type="button"
              pButton
              label="Quay lại"
              [disabled]="!isValidGobackToStatue"
              class="p-button-outlined"
              style="height: 40px; margin: 0 0.5rem 0 0; border: 3px solid"
              (click)="
                isShowingStatueDialog = true;
                isShowingSectionDialog = false;
                isShowingParagraphDialog = false;
                isSectionWithNoParagraph = false;
                tmpReferenceListOfNewSectionWithNoParagraph = [];
                tmpReferenceNewSectionWithNoParagraph = undefined;
                newSectionWithNoParagraphReferenceSelectedStatue = undefined;
                newSectionWithNoParagraphReferenceSelectedSection = undefined;
                newSectionWithNoParagraphReferenceSelectedParagraph = undefined
              "
            ></button>
            <!-- this commented out part is of disabled property -->
            <!-- isAddedNewSection = false; -->

            <button
              type="button"
              pButton
              label="Kế tiếp"
              class="p-button-primary"
              [disabled]="!isValidGoNextOnSectionDialog"
              style="height: 40px; margin: 0"
              (click)="
                selectAnotherSectionOrDefaultSectionSelected();
                loadStatuesForAddingReferenceOfNewParagraph();
                loadKeywordListForNewParagraph();
                isShowingStatueDialog = false;
                isShowingSectionDialog = false;
                isShowingParagraphDialog = true
              "
            ></button>
            <!-- initValueForNewParagraph(); -->
          </div>

          <div class="w-6 flex justify-content-end">
            <button
              type="button"
              pButton
              label="Hoàn thành"
              [disabled]="!isValidFinishOnSectionDialog"
              class="p-button-outlined p-button-success"
              style="height: 40px; margin: 0; border: 3px solid"
              (click)="isShowingConfirmAddNewLaw = true; getApprovalRate()"
            ></button>
            <!-- this part commented is of disabled -->
            <!-- isSectionWithNoParagraph &&
                isAddedNewSection &&
                !isValidGoNextOnSectionDialog
                  ? false
                  : true -->
          </div>
        </div>
      </div>
    </div>

    <!-- footer for adding paragraphs -->
    <div
      class="p-2"
      *ngIf="
        !isShowingStatueDialog &&
        !isShowingSectionDialog &&
        isShowingParagraphDialog &&
        !isShowingConfirmAddNewLaw
      "
    >
      <div
        class="w-full flex justify-content-center"
        *ngIf="selectedStatueForAddNewLaw"
      >
        <div class="w-8 flex">
          <div class="w-5 flex justify-content-start align-items-end">
            <button
              type="button"
              pButton
              label="Quay lại"
              [disabled]="!isValidGobackToSection"
              class="p-button-outlined"
              style="height: 40px; margin: 0 0.5rem 0 0; border: 3px solid"
              (click)="
                isShowingStatueDialog = false;
                isShowingSectionDialog = true;
                isShowingParagraphDialog = false
              "
            ></button>
          </div>

          <div
            class="w-7 flex justify-content-end"
            *ngIf="isValidDisplayFinishAndSaveOnParagraphDialog"
          >
            <div class="w-6 flex justify-content-end">
              <button
                type="button"
                pButton
                label="Lưu lại"
                [disabled]="!isValidSaveNewParagraph"
                class="p-button-outlined p-button-warning"
                style="height: 40px; margin: 0; border: 3px solid"
                (click)="saveNewParagraph()"
              ></button>
            </div>

            <div class="w-6 flex justify-content-end">
              <button
                type="button"
                pButton
                label="Hoàn thành"
                [disabled]="
                  newParagraphListOfSelectedSection &&
                  newParagraphListOfSelectedSection.length >= 1
                    ? false
                    : true
                "
                class="p-button-outlined p-button-success"
                style="height: 40px; margin: 0; border: 3px solid"
                (click)="isShowingConfirmAddNewLaw = true; getApprovalRate()"
              ></button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- footer for confirm add new law-->
    <div class="p-2" *ngIf="isShowingConfirmAddNewLaw">
      <div class="w-12 flex justify-content-center">
        <div class="w-8 flex">
          <div class="w-6 flex justify-content-start">
            <button
              type="button"
              pButton
              label="Quay lại"
              class="p-button-outlined"
              style="height: 40px; margin: 0 0.5rem 0 0; border: 3px solid"
              (click)="
                isShowingConfirmAddNewLaw = false;
                isShowingStatueDialog = false;
                isShowingSectionDialog =
                  isAddedNewSection &&
                  selectedSectionForAddNewLaw?.isSectionWithNoParagraph
                    ? true
                    : false;
                isShowingParagraphDialog =
                  isAddedNewSection &&
                  selectedSectionForAddNewLaw?.isSectionWithNoParagraph
                    ? false
                    : true
              "
            ></button>
          </div>

          <div class="w-6 flex justify-content-end">
            <button
              type="button"
              pButton
              label="Hoàn thành"
              class="p-button-success"
              style="height: 40px; margin: 0; border: 3px solid; width: 8rem"
              (click)="confirmedAddNewLaw()"
            ></button>
          </div>
        </div>
      </div>
    </div>
  </ng-template>
</p-dialog>

<!-- Confirm delete new paragraph in new paragraph list -->
<p-dialog
  [(visible)]="displayConfirmDeleteNewParagraphInNewParagraphList"
  [modal]="true"
>
  <ng-template pTemplate="header">
    <span class="text-red-500 font-bold text-xl">Xóa</span>
  </ng-template>

  <div class="w-full text-center">
    <span class="text-lg"
      >Các điểm trong danh sách sẽ bị đổi tên điểm tương ứng. Bạn có chắc
      chắn?</span
    >
  </div>

  <ng-template pTemplate="footer">
    <button
      type="button"
      pButton
      icon="pi pi-times"
      label="Hủy"
      class="p-button-danger"
      style="height: 40px"
      (click)="displayConfirmDeleteNewParagraphInNewParagraphList = false"
    ></button>
    <button
      type="button"
      pButton
      icon="pi pi-check"
      label="Đồng ý"
      class="p-button-success"
      style="height: 40px"
      (click)="deleteNewParagraphInNewParagraphList()"
    ></button>
  </ng-template>
</p-dialog>

<!-- Confirm delete new section -->
<p-dialog [(visible)]="displayConfirmDeleteNewSection" [modal]="true">
  <ng-template pTemplate="header">
    <span class="text-red-500 font-bold text-xl">Xóa</span>
  </ng-template>

  <div class="w-full text-center">
    <span class="text-lg"
      >{{ newSection?.name }} sẽ bị xóa. Bạn có chắc chắn?</span
    >
  </div>

  <ng-template pTemplate="footer">
    <button
      type="button"
      pButton
      icon="pi pi-times"
      label="Hủy"
      class="p-button-danger"
      style="height: 40px"
      (click)="displayConfirmDeleteNewSection = false"
    ></button>
    <button
      type="button"
      pButton
      icon="pi pi-check"
      label="Đồng ý"
      class="p-button-success"
      style="height: 40px"
      (click)="deleteNewSection()"
    ></button>
  </ng-template>
</p-dialog>

<!-- Add new -> start from paragraph screen dialog -->
<p-dialog
  [(visible)]="displayAddNewParagraphDialog"
  [style]="{ width: '50vw' }"
  [modal]="true"
  (onHide)="clearAddNewAllData()"
>
  <ng-template pTemplate="content">
    <!-- body for create new paragraphs -->
    <div class="p-2 h-full" *ngIf="!isShowingConfirmAddNewLaw">
      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-8 flex">
          <div class="w-6">
            <span class="text-lg">Điều: </span>
          </div>
          <div class="w-6 flex justify-content-end">
            <span class="text-lg font-bold">{{
              selectedStatueForAddNewLaw?.name
            }}</span>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-8 flex">
          <div class="w-6">
            <span class="text-lg">Khoản: </span>
          </div>
          <div class="w-6 flex justify-content-end">
            <span class="text-lg font-bold">{{
              selectedSectionForAddNewLaw?.name
            }}</span>
          </div>
        </div>
      </div>

      <div
        class="w-12 flex justify-content-center"
        *ngIf="
          newParagraphListOfSelectedSection &&
          newParagraphListOfSelectedSection.length > 0 &&
          !isUpdatingNewParagraph
        "
      >
        <div class="w-8">
          <span class="text-lg">Điểm: </span>
        </div>
      </div>
      <div
        class="w-12 flex justify-content-center"
        *ngIf="
          !isUpdatingNewParagraph &&
          newParagraphListOfSelectedSection &&
          newParagraphListOfSelectedSection.length > 0
        "
      >
        <div class="w-8 max-h-5rem overflow-auto">
          <ul>
            <li
              *ngFor="
                let newParagraph of newParagraphListOfSelectedSection;
                let i = index
              "
              class="flex align-items-center"
            >
              <div class="w-3">
                <fa-icon
                  class="mr-2 fa-2xs"
                  [icon]="['fas', 'circle']"
                ></fa-icon>
                {{ newParagraph?.name }} )
              </div>
              <div
                class="w-6 overflow-hidden white-space-nowrap text-overflow-ellipsis"
              >
                {{ newParagraph?.description }}
              </div>
              <div class="w-3 flex justify-content-end">
                <button
                  pButton
                  pRipple
                  type="button"
                  icon="pi pi-file-edit"
                  class="p-button-rounded p-button-text"
                  (click)="openUpdateNewSectionParagraph(i)"
                ></button>
                <button
                  pButton
                  rRipple
                  type="button"
                  icon="pi pi-trash"
                  class="p-button-rounded p-button-danger p-button-text"
                  (click)="confirmDeleteNewParagraphInNewParagraphList(i)"
                ></button>
              </div>
            </li>
          </ul>
        </div>
      </div>

      <div
        class="w-12 flex justify-content-center"
        *ngIf="
          !isUpdatingNewParagraph &&
          newParagraphListOfSelectedSection &&
          newParagraphListOfSelectedSection.length > 0
        "
      >
        <hr class="w-6 border-top-1" />
      </div>

      <div
        class="w-12 flex justify-content-center mb-1"
        *ngIf="!isUpdatingNewParagraph"
      >
        <div class="w-8 flex justify-content-center">
          <span class="text-2xl font-bold text-black-500 mb-3">
            Tạo mới Điểm
          </span>
          <span
            class="text-2xl font-bold text-black-500 mb-3"
            *ngIf="isUpdatingNewParagraph"
          >
            Cập nhật Điểm
          </span>
        </div>
      </div>

      <div
        class="w-12 flex justify-content-center mb-1"
        *ngIf="isUpdatingNewParagraph"
      >
        <div class="w-8 flex justify-content-center mb-3">
          <div class="w-6">
            <span class="text-xl font-bold text-black-500">
              Cập nhật
              {{
                newParagraphListOfSelectedSection[updatingParagraphIndex]?.name
              }}
            </span>
          </div>
          <div class="w-6 flex justify-content-end">
            <button
              pButton
              pRipple
              type="button"
              label="Lưu"
              [disabled]="!isValidSaveNewParagraph"
              [style]="{ height: '35px', border: '3px solid' }"
              class="p-button-success p-button-outlined mr-2"
              (click)="saveUpdatedNewParagraph()"
            ></button>

            <button
              pButton
              pRipple
              type="button"
              label="Hủy"
              [style]="{ height: '35px', border: '3px solid' }"
              class="p-button-danger p-button-outlined mr-2"
              (click)="cancleUpdatedNewParagraph()"
            ></button>
          </div>
        </div>
      </div>

      <div
        class="w-12 flex justify-content-center mb-3"
        *ngIf="!isUpdatingNewParagraph"
      >
        <div class="w-8 flex">
          <div class="w-6">
            <span class="text-lg">Điểm: </span>
          </div>
          <div class="w-6 flex justify-content-end">
            <span class="text-lg font-bold">
              {{ newParagraphOfSelectedSection?.name }}
            </span>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center">
        <div class="w-8">
          <div class="w-6">
            <span class="text-lg">Nội dung : </span>
          </div>
        </div>
      </div>
      <div class="w-12 flex justify-content-center">
        <div class="w-8">
          <textarea
            [(ngModel)]="newParagraphOfSelectedSectionDescription"
            class="w-full h-6rem overflow-y-auto"
            [rows]="10"
            pInputTextarea
            placeholder="Nội dung..."
            (keyup)="getNewParagraphDescription($event)"
          ></textarea>
        </div>
      </div>
      <div class="w-12 flex justify-content-center mb-3">
        <div class="w-8">
          <span class="p-error block" *ngIf="newParagraphDescriptionInvalidMsg">
            {{ newParagraphDescriptionInvalidMsg }}
          </span>
        </div>
      </div>

      <div class="w-12 flex justify-content-center">
        <div class="w-8">
          <div class="w-6">
            <span class="text-lg">Hình phạt bổ sung (nếu có) : </span>
          </div>
        </div>
      </div>
      <div class="w-12 flex justify-content-center mb-3">
        <div class="w-8">
          <textarea
            [(ngModel)]="newParagraphOfSelectedSectionAdditionalPenalty"
            class="w-full h-4rem overflow-y-auto"
            [rows]="10"
            pInputTextarea
            placeholder="Hình phạt bổ sung..."
            (keyup)="getNewParagraphAdditionalPenalty($event)"
          ></textarea>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-3">
        <div class="w-8">
          <span
            class="p-error block"
            *ngIf="newParagraphAdditionalPenaltyInvalidMsg"
          >
            {{ newParagraphAdditionalPenaltyInvalidMsg }}
          </span>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-3">
        <div class="w-8 flex align-items-center">
          <div class="w-6">
            <span class="text-lg">Thuộc nhóm từ khóa (nếu có): </span>
          </div>
          <div class="w-6 flex justify-content-end">
            <p-dropdown
              id="new-paragraph-dropdown-keywords"
              [(ngModel)]="newParagraphSelectedKeyword"
              [options]="newParagraphKeywordList"
              optionLabel="name"
              [style]="{ height: '35px', width: '14rem' }"
              placeholder="Nhóm từ khóa..."
              scrollHeight="6rem"
              [filter]="true"
              filterBy="name"
              [showClear]="true"
              (onChange)="selectKeywordForNewParagraph($event)"
            ></p-dropdown>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-3">
        <div class="w-8 flex">
          <div class="w-6 text-lg">Sửa đổi bổ sung bởi (nếu có)</div>
          <div class="w-6 text-lg flex justify-content-end">
            <p-dropdown
              [disabled]="!newParagraphOfSelectedSectionDescription"
              [options]="changingDecrees"
              optionLabel="decreeName"
              [(ngModel)]="selectedChangingDecree"
              placeholder="---------"
              [showClear]="true"
              scrollHeight="6rem"
              [filter]="true"
              filterBy="decreeName"
              [style]="{ width: '14rem', height: '35px' }"
              class="dropdown-changing-decrees"
              (onChange)="selectChangingDecreeForAddingNewParagraph()"
            >
              <ng-template
                let-changingDecree
                pTemplate="item"
                class="dropdown-changing-decrees-tooltip"
              >
                <div
                  [pTooltip]="changingDecree.decreeName"
                  tooltipPosition="left"
                  class="w-11rem overflow-hidden whitespace-no-wrap text-overflow-ellipsis"
                  [style]="{ height: '2.5rem' }"
                >
                  <span>{{ changingDecree.decreeName }}</span>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-3">
        <div class="w-8 flex">
          <div class="w-6">
            <span class="text-lg">Các hành vi liên quan (nếu có): </span>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-8 flex">
          <div class="w-4 flex justify-content-start">
            <p-dropdown
              [(ngModel)]="newParagraphReferenceSelectedStatue"
              [options]="newParagraphReferenceStatueList"
              optionLabel="name"
              [style]="{ height: '35px', width: '8rem' }"
              placeholder="Điều..."
              scrollHeight="6rem"
              [filter]="true"
              filterBy="name"
              (onChange)="selectStatueReferenceForNewParagraph($event)"
            ></p-dropdown>
          </div>
          <div class="w-4 flex justify-content-center">
            <p-dropdown
              [(ngModel)]="newParagraphReferenceSelectedSection"
              [options]="newParagraphReferenceSectionList"
              optionLabel="name"
              [style]="{ height: '35px', width: '9rem' }"
              placeholder="Khoản..."
              scrollHeight="6rem"
              [filter]="true"
              filterBy="name"
              (onChange)="selectSectionReferenceForNewParagraph($event)"
            ></p-dropdown>
          </div>
          <div class="w-4 flex justify-content-end">
            <p-dropdown
              [(ngModel)]="newParagraphReferenceSelectedParagraph"
              [options]="newParagraphReferenceParagraphList"
              optionLabel="name"
              [style]="{ height: '35px', width: '8rem' }"
              placeholder="Điểm..."
              scrollHeight="6rem"
              [filter]="true"
              filterBy="name"
              (onChange)="selectParagraphReferenceForNewParagraph($event)"
            ></p-dropdown>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center align-items-center mb-5">
        <div class="w-8 flex align-items-center">
          <div class="w-10 flex">
            <div class="w-6 flex">
              <div class="p-field-radiobutton">
                <p-radioButton
                  [value]="false"
                  [(ngModel)]="tmpReferenceOfNewParagraphIsExcluded"
                  inputId="isIncluded"
                  (onClick)="chooseNewParagraphIncludedExcluded($event)"
                ></p-radioButton>
                <label for="isIncluded" class="ml-2">Hành vi bao gồm</label>
              </div>
            </div>
            <div class="w-6 flex">
              <div class="p-field-radiobutton">
                <p-radioButton
                  [value]="true"
                  [(ngModel)]="tmpReferenceOfNewParagraphIsExcluded"
                  inputId="isExcluded"
                  (onClick)="chooseNewParagraphIncludedExcluded($event)"
                ></p-radioButton>
                <label for="isExcluded" class="ml-2">Hành vi ngoại trừ</label>
              </div>
            </div>
          </div>
          <div class="w-2 flex justify-content-end">
            <div class="w-12">
              <button
                pButton
                pRipple
                type="button"
                label="Thêm"
                [disabled]="
                  newParagraphReferenceSelectedStatue &&
                  newParagraphReferenceSelectedSection &&
                  newParagraphReferenceSelectedParagraph &&
                  tmpReferenceOfNewParagraph.referenceParagraphIsExcluded !==
                    undefined
                    ? false
                    : true
                "
                [style]="{ height: '35px', border: '3px solid' }"
                class="p-button-success p-button-outlined mr-2"
                (click)="addNewParagraphReferenceToTmpReferenceList()"
              ></button>
            </div>
          </div>
        </div>
      </div>

      <div
        class="w-12 flex justify-content-center mb-2"
        *ngIf="!isValidAddReferenceToNewParagraph"
      >
        <div class="w-8 flex justify-content-center">
          <span class="font-bold text-red-400"
            >Điểm đã tồn tại trong danh sách</span
          >
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-8 h-7rem overflow-y-auto">
          <div
            *ngFor="
              let newReference of tmpReferenceListOfNewParagraph;
              let i = index
            "
            class="flex align-items-center ml-8"
          >
            <span>
              {{ newReference.referenceParagraphSectionStatueName }} *
              {{ newReference.referenceParagraphSectionName }} *
              {{ newReference.referenceParagraphName }}
            </span>
            <span
              *ngIf="newReference?.referenceParagraphIsExcluded"
              class="text-blue-300"
              >&nbsp;(ngoại trừ)
            </span>
            <span
              *ngIf="!newReference?.referenceParagraphIsExcluded"
              class="text-orange-300"
              >&nbsp;(bao gồm)
            </span>
            <button
              pButton
              type="button"
              icon="pi pi-times"
              class="p-button-rounded p-button-danger p-button-text"
              (click)="removeNewParagraphReference(i)"
            ></button>
          </div>
        </div>
      </div>
    </div>

    <!-- body for confirm create paragraphs -->
    <div class="p-2 h-full" *ngIf="isShowingConfirmAddNewLaw">
      <div class="w-12 flex justify-content-center mb-4">
        <div class="w-8 flex justify-content-center">
          <span class="text-2xl font-bold mb-3">Tạo mới luật</span>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-10">
          <span class="text-xl text-700"
            >Xác nhận tạo mới những Điểm sau:
          </span>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-8 flex">
          <div class="w-6"><span class="text-lg">Gửi yêu cầu tới:</span></div>
          <div class="w-6 flex justify-content-end">
            <p-dropdown
              [options]="admins"
              optionLabel="username"
              [(ngModel)]="selectedAdmin"
              scrollHeight="6rem"
              [filter]="true"
              filterBy="username"
              [style]="{ width: '10rem', height: '35px' }"
              class="dropdown-admins"
            >
              <ng-template
                let-admin
                pTemplate="item"
                class="dropdown-admins-tooltip"
              >
                <div
                  [pTooltip]="admin.pendingRequests"
                  tooltipPosition="left"
                  class="w-full h-3rem flex justify-content-center align-items-center whitespace-no-wrap text-overflow-ellipsis"
                >
                  <span>{{ admin.username }}</span>
                </div>
              </ng-template>
            </p-dropdown>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-8 flex align-items-center">
          <div class="w-6">
            <span class="text-lg">Điều: </span>
          </div>
          <div class="w-6 flex justify-content-end">
            <span class="text-lg font-bold">{{
              selectedStatueForAddNewLaw?.name
            }}</span>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-8 flex align-items-center">
          <div class="w-6">
            <span class="text-lg">Khoản: </span>
          </div>
          <div class="w-6 flex justify-content-end">
            <span class="text-lg font-bold">{{
              selectedSectionForAddNewLaw?.name
            }}</span>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-8 align-items-center">
          <div class="w-6">
            <span class="text-lg">Điểm: </span>
          </div>
        </div>
      </div>

      <div class="w-12 flex justify-content-center mb-2">
        <div class="w-8 p-3max-h-8rem overflow-y-auto overflow-x-hidden">
          <ul *ngFor="let newParagraph of newParagraphListOfSelectedSection">
            <li class="flex align-items-center">
              <div class="w-3">
                <fa-icon
                  class="mr-2 fa-2xs"
                  [icon]="['fas', 'circle']"
                ></fa-icon>
                {{ newParagraph?.name }} )
              </div>
              <div
                class="w-9 overflow-hidden white-space-nowrap text-overflow-ellipsis"
              >
                <span>{{ newParagraph?.description }}</span>
              </div>
            </li>
          </ul>
        </div>
      </div>

      <div class="w-12 flex justify-content-center">
        <div class="w-8 text-left p-2 border-blue-200 border-2 border-round-md">
          <span class="font-bold text-lg">Lưu ý: </span><br />
          + Tỷ lệ phê duyệt hiện tại:
          <span class="font-bold" *ngIf="totalRomCount !== 0"
            >{{
              (1 - deniedRomCount / totalRomCount) * 100 | number: "2.0-2"
            }}%</span
          >
          <span *ngIf="totalRomCount === 0" class="font-bold"
            >Chưa có dữ liệu</span
          >
          <br />
          + Tỷ lệ phê duyệt (nếu yêu cầu được chấp nhận):
          <span class="font-bold"
            >{{
              (1 - deniedRomCount / (totalRomCount + 1)) * 100
                | number: "2.0-2"
            }}%</span
          ><br />
          + Tỷ lệ phê duyệt (nếu yêu cầu bị từ chối):
          <span class="font-bold"
            >{{
              (1 - (deniedRomCount + 1) / (totalRomCount + 1)) * 100
                | number: "1.0-2"
            }}%</span
          ><br />
          <div class="text-center">
            <span class="font-bold font-italic text-red-300 text-sm"
              >Nếu tỷ lệ phê duyệt < 65%, tài khoản sẽ bị ngưng hoạt động bởi hệ
              thống</span
            >
          </div>
        </div>
      </div>
    </div>
  </ng-template>

  <ng-template pTemplate="footer">
    <!-- footer for adding paragraphs -->
    <div class="p-2" *ngIf="!isShowingConfirmAddNewLaw">
      <div
        class="w-12 flex justify-content-center"
        *ngIf="selectedStatueForAddNewLaw"
      >
        <div class="w-8 flex justify-content-end">
          <div *ngIf="isValidDisplayFinishAndSaveOnParagraphDialog">
            <button
              type="button"
              pButton
              label="Lưu lại"
              [disabled]="!isValidSaveNewParagraph"
              class="p-button-outlined p-button-warning mr-3"
              style="height: 40px; margin: 0; border: 3px solid"
              (click)="saveNewParagraph()"
            ></button>
            <button
              type="button"
              pButton
              label="Hoàn thành"
              [disabled]="
                newParagraphListOfSelectedSection &&
                newParagraphListOfSelectedSection.length >= 1
                  ? false
                  : true
              "
              class="p-button-outlined p-button-success"
              style="height: 40px; margin: 0; border: 3px solid"
              (click)="isShowingConfirmAddNewLaw = true; getApprovalRate()"
            ></button>
          </div>
        </div>
      </div>
    </div>

    <!-- footer for confirm add new paragraphs-->
    <div class="p-2" *ngIf="isShowingConfirmAddNewLaw">
      <div class="w-12 flex justify-content-center">
        <div class="w-8 flex">
          <div class="w-6 flex justify-content-start">
            <button
              type="button"
              pButton
              label="Quay lại"
              class="p-button-outlined"
              style="height: 40px; margin: 0 0.5rem 0 0; border: 3px solid"
              (click)="
                isShowingConfirmAddNewLaw = false;
                isShowingParagraphDialog = true
              "
            ></button>
          </div>

          <div class="w-6 flex justify-content-end">
            <button
              type="button"
              pButton
              label="Hoàn thành"
              class="p-button-success"
              style="height: 40px; margin: 0; border: 3px solid; width: 8rem"
              (click)="confirmedAddNewLaw()"
            ></button>
          </div>
        </div>
      </div>
    </div>
  </ng-template>
</p-dialog>
